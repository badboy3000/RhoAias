exports.ids=[72],exports.modules={187:function(t,e,r){"use strict";r.d(e,"i",function(){return n}),r.d(e,"r",function(){return o}),r.d(e,"h",function(){return c}),r.d(e,"c",function(){return l}),r.d(e,"o",function(){return d}),r.d(e,"f",function(){return _}),r.d(e,"m",function(){return m}),r.d(e,"e",function(){return h}),r.d(e,"p",function(){return f}),r.d(e,"a",function(){return v}),r.d(e,"n",function(){return x}),r.d(e,"j",function(){return y}),r.d(e,"d",function(){return $}),r.d(e,"b",function(){return w}),r.d(e,"g",function(){return k}),r.d(e,"q",function(){return I}),r.d(e,"l",function(){return C}),r.d(e,"k",function(){return S});const n=(t,{id:e})=>t.$axios.$get(`cartoon_role/${e}/stock_show`),o=(t,{id:e,amount:r})=>t.$axios.$post(`cartoon_role/${e}/buy_stock`,{amount:r}),c=(t,{id:e})=>t.$axios.$get(`cartoon_role/${e}/get_idol_deal`),l=(t,form)=>t.$axios.$post("cartoon_role/create_deal",form),d=(t,form)=>t.$axios.$post("cartoon_role/make_deal",form),_=(t,{id:e})=>t.$axios.$post("cartoon_role/delete_deal",{id:e}),m=t=>t.$axios.$get("cartoon_role/stock_meta"),h=(t,form)=>t.$axios.$post("cartoon_role/create_market_price_draft",form),f=(t,{is_agree:e,idol_id:r,draft_id:n})=>t.$axios.$post("cartoon_role/vote_market_price_draft",{is_agree:e,idol_id:r,draft_id:n}),v=(t,{idol_id:e,qq_group:r,lover_words:n,manager_id:o})=>t.$axios.$post("cartoon_role/change_idol_profile",{idol_id:e,qq_group:r,lover_words:n,manager_id:o}),x=t=>t.$axios.$get("cartoon_role/user_draft_work"),y=t=>t.$axios.$get("cartoon_role/can_use_income"),$=(t,{product_id:e,product_type:r,amount:n})=>t.$axios.$post("cartoon_role/create_buy_request",{product_id:e,product_type:r,amount:n}),w=(t,{order_id:e,result:r})=>t.$axios.$post("cartoon_role/check_product_request",{order_id:e,result:r}),k=(t,{order_id:e})=>t.$axios.$post("cartoon_role/delete_buy_request",{order_id:e}),I=(t,{order_id:e})=>t.$axios.$post("cartoon_role/over_buy_request",{order_id:e}),C=t=>t.$axios.$get("cartoon_role/get_mine_product_orders"),S=(t,{idol_id:e,days:r})=>t.$axios.$get("cartoon_role/get_idol_days_chart",{params:{idol_id:e,days:r}})},193:function(t,e){},214:function(t,e){t.exports={"image-preview":"image-preview-2_",imagePreview:"image-preview-2_",container:"container-34",bar:"bar-1j","top-bar":"top-bar-1d",topBar:"top-bar-1d","foot-bar":"foot-bar-AF",footBar:"foot-bar-AF",wrap:"wrap-tx",item:"item-32",close:"close-27",download:"download-51","next-btn":"next-btn-3T",nextBtn:"next-btn-3T","prev-btn":"prev-btn-12",prevBtn:"prev-btn-12",rolling:"rolling-3m"}},225:function(t,e,r){"use strict";r.r(e);var n=r(193),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},232:function(t,e,r){"use strict";var n={name:"SocialPanel",props:{isCreator:{required:!0,type:Boolean},isMine:{required:!0,type:Boolean},id:{required:!0,type:[Number,String]},type:{required:!0,type:String,validator:t=>~["post","video","image","score","answer","video"].indexOf(t)}},computed:{isGuest(){return!this.$store.state.login},source(){return this.$store.getters["social/getState"](this.type,this.id)},displayUsers(){return(this.isCreator?this.source.reward_users.list:this.source.like_users.list).slice(0,this.displayCount)}},methods:{computeTextByAction:t=>"reward"===t?"投食":"like"===t?"喜欢":"mark"===t?"收藏":"操作",toggleAction(t){if(this.isGuest)this.$channel.$emit("sign-in");else if(this.isMine)this.$toast.info(`不能${this.computeTextByAction(t)}自己的内容`);else if("reward"===t){if(this.source.reward)return void this.$toast.info("已投食过");this.$confirm("向TA投食需要消耗你一个团子，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.submitAction("reward")}).catch(()=>{})}else this.submitAction(t)},async submitAction(t){const data=await this.$store.dispatch("social/toggleAction",{type:this.type,id:this.id,action:t});data.success&&this.$emit(`${t}-callback`,{result:data.result})}}},o=r(1);var component=Object(o.a)(n,function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.source?r("div",{staticClass:"ours-panel"},[t._ssrNode('<div class="buttons">',"</div>",[t.isCreator?r("el-button",{class:{"is-plain":t.source.reward},attrs:{loading:t.source.reward_loading,type:"warning",icon:"iconfont icon-fantuan",round:"",size:"mini"},on:{click:function(e){return t.toggleAction("reward")}}},[t._v("\n      "+t._s(t.source.reward?"已投食":"投食")+t._s(t.source.reward_users.total?"  |  "+t.source.reward_users.total:"")+"\n    ")]):t._e(),t._ssrNode(" "),r("el-button",{class:{"is-plain":t.source.like},attrs:{loading:t.source.like_loading,type:"danger",icon:"iconfont icon-like",round:"",size:"mini"},on:{click:function(e){return t.toggleAction("like")}}},[t._v("\n      "+t._s(t.source.like?"已喜欢":"喜欢")+t._s(t.source.like_users.total?"  |  "+t.source.like_users.total:"")+"\n    ")]),t._ssrNode(" "),r("el-button",{class:{"is-plain":t.source.mark},attrs:{loading:t.source.mark_loading,type:"success",icon:"iconfont icon-mark",round:"",size:"mini"},on:{click:function(e){return t.toggleAction("mark")}}},[t._v("\n      "+t._s(t.source.mark?"已收藏":"收藏")+t._s(t.source.mark_users.total?"  |  "+t.source.mark_users.total:"")+"\n    ")])],2),t._ssrNode(' <div class="users"><ul>'+t._ssrList(t.displayUsers,function(e){return'<li class="user-face"><img'+t._ssrAttr("src",t.$resize(e.avatar,{width:60}))+"></li>"})+"</ul></div>")],2):t._e()},[],!1,function(t){var e=r(225);e.__inject__&&e.__inject__(t)},null,"379e1343");e.a=component.exports},238:function(t,e,r){"use strict";r.d(e,"b",function(){return n}),r.d(e,"a",function(){return o}),r.d(e,"c",function(){return c});const n=(t,{id:e,only:r,hash:n,time:time})=>t.$axios.$get(`post/${e}/show`,{params:{only:r,hash:n,time:time}}),o=(t,{title:title,bangumiId:e,content:content,images:r,tags:n,desc:desc,geetest:o,is_creator:c})=>t.$axios.$post("post/create",{title:title,bangumiId:e,content:content,images:r,tags:n,desc:desc,geetest:o,is_creator:c}),c=t=>t.$axios.$get("post/tags")},239:function(t,e){},240:function(t,e){},254:function(t,e,r){"use strict";var n={name:"ImagePreview",props:{images:{type:Array,default:()=>[]},query:{type:String,default:""},download:{type:Boolean,default:!0}},data(){return{show:!1,currentIndex:-1,maxWidth:0,maxHeight:0,displayImages:this.images.map(t=>Object.assign({finalWidth:0,finalHeight:0,loading:!0},t))}},computed:{total(){return this.images.length},currentImage(){return-1===this.currentIndex?null:this.displayImages[this.currentIndex]},isWechat(){return this.$store.state.ua.wechat}},mounted(){this.getScreenSize(),window.addEventListener("resize",this.getScreenSize)},methods:{handleClose(){this.show=!1},handleClick(t){if(this.isWechat)return;if(!this.total)return;const e=t.target,r="img"===e.tagName.toLowerCase();if(!this.query&&!r)return;if(this.query&&-1===e.className.indexOf(this.query))return;let n="";if(r)n=e.getAttribute("src").split("?")[0];else{const img=e.querySelector("img");if(!img)return;n=img.getAttribute("src").split("?")[0]}this.getClickImageIndex(n),this.computeDisplaySize(this.currentIndex),this.show=!0},getClickImageIndex(t){this.images.forEach((image,e)=>{image.url===t&&(this.currentIndex=e)})},getScreenSize(){this.maxWidth=window.innerWidth,this.maxHeight=window.innerHeight-88},switchImage(t){if(t&&this.currentIndex===this.total-1)return;if(!t&&0===this.currentIndex)return;const e=t?this.currentIndex+1:this.currentIndex-1;this.computeDisplaySize(e),this.currentIndex=e},getSiblingsIndex(t){let e,r;return 0===this.currentIndex?(e=this.total-1,r=1):this.currentIndex===this.total-1?(e=this.total-2,r=0):(e=this.currentIndex-1,r=this.currentIndex+1),[e,t,r]},computeDisplaySize(t){if(void 0===this.images[t])return;const image=this.images[t];if(image.finalWidth&&image.finalHeight)return;const e=image.width,r=image.height,n=this.maxWidth,o=this.maxHeight;let c,l;if(n>=e&&o>=r)c=e,l=r;else if(n<e&&o<r){const t=e/o,d=r/o;t>=d?(c=n,l=parseInt(r/t,10)):(c=parseInt(e/d,10),l=o)}else if(r<o){c=n,l=parseInt(r/(e/o),10)}else{c=parseInt(e/(r/o),10),l=o}this.displayImages[t].finalWidth=c||n,this.displayImages[t].finalHeight=l||o},handleSwitch(t,e){this.currentIndex=e}}},o=r(1);var component=Object(o.a)(n,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{class:t.$style.imagePreview,on:{click:t.handleClick}},[t._ssrNode((t.show?"<div"+t._ssrClass(null,t.$style.container)+"><div"+t._ssrClass(null,[t.$style.bar,t.$style.topBar])+">"+(t.total?"<span"+t._ssrClass(null,t.$style.total)+">"+t._ssrEscape("\n        "+t._s(t.currentIndex+1)+"/"+t._s(t.total)+"\n      ")+"</span>":"\x3c!----\x3e")+" <span"+t._ssrClass(null,t.$style.close)+"> × </span></div> <div"+t._ssrClass(null,[t.$style.bar,t.$style.footBar])+">"+(t.currentImage&&t.download?"<a"+t._ssrAttr("href",t.currentImage.url)+' target="_blank"'+t._ssrClass(null,t.$style.download)+">\n        下载原图\n      </a>":"\x3c!----\x3e")+"</div> "+(t.currentImage?"<div"+t._ssrClass(null,t.$style.wrap)+"><div"+t._ssrClass(null,t.$style.item)+t._ssrStyle(null,{backgroundImage:"url("+t.$resize(t.currentImage.url,{webP:!t.download})+")",width:""+t.$px2vw(t.currentImage.finalWidth),height:""+t.$px2vw(t.currentImage.finalHeight)},null)+"></div> "+(t.total>1?"<button"+t._ssrClass(null,t.$style.prevBtn)+'><i class="el-icon-caret-left"></i></button> <button'+t._ssrClass(null,t.$style.nextBtn)+'><i class="el-icon-caret-right"></i></button>':"\x3c!----\x3e")+"</div>":"\x3c!----\x3e")+"</div>":"\x3c!----\x3e")+" "),t._t("default")],2)},[],!1,function(t){var e=r(257);e.__inject__&&e.__inject__(t),this.$style=e.locals||e},null,"c07ef6ca");e.a=component.exports},257:function(t,e,r){"use strict";r.r(e);var n=r(214),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},289:function(t,e){},290:function(t,e,r){"use strict";r.r(e);var n=r(239),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},291:function(t,e,r){"use strict";r.r(e);var n=r(240),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},357:function(t,e,r){"use strict";var n=r(232),o=r(254),c=(r(89),r(2),r(46)),l=r.n(c),d=(r(289),r(156)),_=r.n(d),m=r(187),h={name:"BuyContentBtn",components:{"mt-spinner":_.a,"el-input-number":l.a},props:{id:{type:String,required:!0},title:{type:String,required:!0},author:{type:String,required:!0},type:{type:String,required:!0}},data:()=>({show:!1,idol:null,price:5,submitting:!1}),methods:{async showBuyModal(){this.show=!0,this.idol=await Object(m.j)(this)},async submitAction(){if(this.price<5)this.$toast.error("不支持5团子以下的采购");else if(this.price>this.idol.income)this.$toast.error("没有足够的资金");else if(!this.submitting&&this.idol){this.submitting=!0;try{await Object(m.d)(this,{product_id:this.id,product_type:this.type,amount:this.price}),this.show=!1,this.$toast.success("请求已发送，等待作者确认")}catch(t){this.$toast.error(t)}finally{this.submitting=!1}}}}},f=r(1);var v=Object(f.a)(h,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("span",{staticClass:"buy-content-btn-wrap"},[t._ssrNode('<button class="buy-content-btn">\n    采购\n  </button> '),r("v-drawer",{attrs:{"header-text":"内容采购","submit-text":"确认",from:"bottom",size:"70%"},on:{submit:t.submitAction},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[r("div",{staticClass:"container"},[t.idol?[r("p",[t._v("\n          以「"+t._s(t.idol.name)+"」经纪人的身份，采购「"+t._s(t.author)+"」的文章《"+t._s(t.title)+"》\n        ")]),t._v(" "),r("br"),t._v(" "),r("p",[t._v("当前可用资金：￥"+t._s(t.idol.income))]),t._v(" "),r("div",[r("br"),t._v(" "),r("p",[r("strong",[t._v("采购价格：")])]),t._v(" "),r("br"),t._v(" "),r("el-input-number",{attrs:{min:5,max:t.idol.income>35?35:t.idol.income},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1),t._v(" "),r("div",[r("br"),t._v(" "),r("p",[r("strong",[t._v("分成比例：")])]),t._v(" "),r("br"),t._v(" "),r("p",[t._v("\n            当前默认的分成比例是\n            5：5（该文章每收到一次投食，就有0.5个团子赠予偶像，0.5个团子归属作者）\n          ")])]),t._v(" "),r("div",[r("br"),t._v(" "),r("p",[r("strong",[t._v("提示：")])]),t._v(" "),r("br"),t._v(" "),r("p",[t._v("\n            确认采购后，等待作者确认，作者同意后才会扣费，并开始计算偶像的盈利\n          ")])]),t._v(" "),r("br")]:r("div",{staticStyle:{"text-align":"center"}},[r("br"),t._v(" "),r("br"),t._v(" "),r("mt-spinner",{attrs:{type:"triple-bounce"}})],1)],2)])],2)},[],!1,function(t){var e=r(290);e.__inject__&&e.__inject__(t)},null,"5c37effc").exports,x=(r(238),{name:"PostContent",components:{SocialPanel:n.a,ImagePreview:o.a,BuyContentBtn:v},props:{post:{type:Object,required:!0},user:{type:Object,required:!0},bangumi:{type:Object,required:!0}},computed:{total(){return this.$store.state.comment.total+1},onlySeeMaster(){return!!parseInt(this.$route.query.only,10)},isMaster(){return!!this.$store.state.login&&this.$store.state.user.id===this.user.id}}});var y=Object(f.a)(x,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"post-content"}},[t._ssrNode('<h1 class="title">'+(t.post.is_nice?'<div class="nice_badge">\n      精\n    </div>':"\x3c!----\x3e")+t._ssrEscape("\n    "+t._s(t.post.title)+"\n  ")+"</h1> "),t._ssrNode('<div class="user">',"</div>",[r("nuxt-link",{staticClass:"avatar",attrs:{to:t.$alias.user(t.user.zone)}},[r("v-img",{attrs:{src:t.user.avatar,avatar:!0,width:"35"}})],1),t._ssrNode(" "),t._ssrNode('<div class="summary">',"</div>",[r("nuxt-link",{staticClass:"nickname",attrs:{to:t.$alias.user(t.user.zone)},domProps:{textContent:t._s(t.user.nickname)}}),t._ssrNode(" "),t._ssrNode('<div class="info">',"</div>",[t._ssrNode("<span>第1楼</span> <span>·</span> "+(t.total>1?"<span>"+t._ssrEscape("共"+t._s(t.total)+"楼")+"</span> <span>·</span>":"\x3c!----\x3e")+" "),r("v-time",{model:{value:t.post.created_at,callback:function(e){t.$set(t.post,"created_at",e)},expression:"post.created_at"}}),t._ssrNode(" "+(t.post.view_count?'<span class="fr"><i class="iconfont icon-yuedu"></i>'+t._ssrEscape("\n          "+t._s(t.$utils.shortenNumber(t.post.view_count))+"\n        ")+"</span>":"\x3c!----\x3e"))],2)],2)],2),t._ssrNode(" "),t._ssrNode('<div class="content">',"</div>",[r("ImagePreview",{staticClass:"image-area",attrs:{images:t.post.images,download:!1}},t._l(t.post.images,function(img,t){return r("div",{key:t,staticClass:"image-package"},[r("v-img",{attrs:{src:img.url,full:!0,width:img.width,height:img.height}})],1)}),0),t._ssrNode(' <div class="text-area">'+t._s(t.post.content)+"</div>")],2),t._ssrNode(" "),t._ssrNode('<div class="tags">',"</div>",[r("router-link",{attrs:{to:t.$alias.bangumi(t.bangumi.id)}},[r("i",{staticClass:"iconfont icon-tag"}),t._v(" "),r("span",{domProps:{textContent:t._s(t.bangumi.name)}})]),t._ssrNode(" "),t.post.idol?r("router-link",{attrs:{to:t.$alias.cartoonRole(t.post.idol.id)}},[r("i",{staticClass:"iconfont icon-tag"}),t._v(" "),r("span",{domProps:{textContent:t._s(t.post.idol.name)}})]):t.post.is_idol_manager&&t.post.is_creator?r("BuyContentBtn",{attrs:{id:t.post.id,title:t.post.title,author:t.user.nickname,type:"post"}}):t._e(),t._ssrNode(" "+t._ssrList(t.post.tags,function(e){return'<span class="tag">'+t._ssrEscape(t._s(e.name))+"</span>"}))],2),t._ssrNode(" "),t._ssrNode('<div class="footer">',"</div>",[r("SocialPanel",{attrs:{id:t.post.id,"is-creator":t.post.is_creator,"is-mine":t.isMaster,type:"post"}})],1)],2)},[],!1,function(t){var e=r(291);e.__inject__&&e.__inject__(t)},null,"13064e1a");e.a=y.exports},473:function(t,e,r){"use strict";r.r(e);var n=r(238),o={name:"WxAppPost",components:{PostContent:r(357).a},props:{id:{type:String,require:!0}},data:()=>({post:null,user:null,bangumi:null}),asyncData({query:t,store:e,params:r,app:o,error:c}){const{id:l}=r;return Object(n.b)(o,{id:l,only:0}).then(data=>{const{post:t,bangumi:r}=data;return e.commit("social/SET_STATE",{type:"post",id:l,data:{like:t.liked,reward:t.rewarded,mark:t.marked,like_users:t.like_users,mark_users:t.mark_users,reward_users:t.reward_users}}),e.commit("social/SET_STATE",{type:"bangumi",id:r.id,data:{follow:r.followed}}),{post:t,bangumi:r,user:data.user}}).catch(t=>{c({statusCode:t.statusCode,message:t.message})})}},c=r(1);var component=Object(c.a)(o,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"wx-app-post"}},[e("PostContent",{attrs:{post:this.post,user:this.user,bangumi:this.bangumi}})],1)},[],!1,function(t){},null,"e9d9831e");e.default=component.exports}};
//# sourceMappingURL=_id.chunk.1a47a830.js.map