exports.ids=[71],exports.modules={174:function(t,e){},176:function(t,e){},178:function(t,e){},179:function(t,e,r){"use strict";var n={name:"UserAvatar",props:{user:{type:Object,required:!0},size:{type:Number,default:40}},methods:{toUser(){this.$router.push(this.$alias.user(this.user.zone))}}},o=r(1);var component=Object(o.a)(n,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"user-avatar",style:{width:t.$px2vw(t.size),height:t.$px2vw(t.size)},on:{click:function(e){return e.stopPropagation(),t.toUser(e)}}},[t._ssrNode("<img"+t._ssrAttr("src",t.$resize(t.user.avatar,{width:2*t.size}))+">")])},[],!1,function(t){var e=r(181);e.__inject__&&e.__inject__(t)},null,"16ffe9a8");e.a=component.exports},181:function(t,e,r){"use strict";r.r(e);var n=r(174),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},183:function(t,e){t.exports={tag:"tag-14",rolling:"rolling-aq"}},184:function(t,e){},192:function(t,e,r){"use strict";var n={name:"UserNickname",props:{user:{type:Object,required:!0},isMaster:{type:Boolean,default:!1}},methods:{toUser(){this.$router.push(this.$alias.user(this.user.zone))}}},o=r(1);var component=Object(o.a)(n,function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"user-nickname"},[this._ssrNode('<div class="nickname"><p class="oneline">'+this._ssrEscape(this._s(this.user.nickname))+"</p></div> "+(this.isMaster?'<span class="badge master-badge"><span>楼主</span></span>':"\x3c!----\x3e"))])},[],!1,function(t){var e=r(195);e.__inject__&&e.__inject__(t)},null,"0ad68c7d");e.a=component.exports},193:function(t,e,r){"use strict";r.d(e,"i",function(){return n}),r.d(e,"r",function(){return o}),r.d(e,"h",function(){return c}),r.d(e,"c",function(){return l}),r.d(e,"o",function(){return d}),r.d(e,"f",function(){return _}),r.d(e,"m",function(){return f}),r.d(e,"e",function(){return m}),r.d(e,"p",function(){return h}),r.d(e,"a",function(){return v}),r.d(e,"n",function(){return x}),r.d(e,"j",function(){return $}),r.d(e,"d",function(){return y}),r.d(e,"b",function(){return w}),r.d(e,"g",function(){return I}),r.d(e,"q",function(){return j}),r.d(e,"l",function(){return k}),r.d(e,"k",function(){return C});const n=(t,{id:e})=>t.$axios.$get(`cartoon_role/${e}/stock_show`),o=(t,{id:e,amount:r})=>t.$axios.$post(`cartoon_role/${e}/buy_stock`,{amount:r}),c=(t,{id:e})=>t.$axios.$get(`cartoon_role/${e}/get_idol_deal`),l=(t,form)=>t.$axios.$post("cartoon_role/create_deal",form),d=(t,form)=>t.$axios.$post("cartoon_role/make_deal",form),_=(t,{id:e})=>t.$axios.$post("cartoon_role/delete_deal",{id:e}),f=t=>t.$axios.$get("cartoon_role/stock_meta"),m=(t,form)=>t.$axios.$post("cartoon_role/create_market_price_draft",form),h=(t,{is_agree:e,idol_id:r,draft_id:n})=>t.$axios.$post("cartoon_role/vote_market_price_draft",{is_agree:e,idol_id:r,draft_id:n}),v=(t,{idol_id:e,qq_group:r,lover_words:n,manager_id:o})=>t.$axios.$post("cartoon_role/change_idol_profile",{idol_id:e,qq_group:r,lover_words:n,manager_id:o}),x=t=>t.$axios.$get("cartoon_role/user_draft_work"),$=t=>t.$axios.$get("cartoon_role/can_use_income"),y=(t,{product_id:e,product_type:r,amount:n})=>t.$axios.$post("cartoon_role/create_buy_request",{product_id:e,product_type:r,amount:n}),w=(t,{order_id:e,result:r})=>t.$axios.$post("cartoon_role/check_product_request",{order_id:e,result:r}),I=(t,{order_id:e})=>t.$axios.$post("cartoon_role/delete_buy_request",{order_id:e}),j=(t,{order_id:e})=>t.$axios.$post("cartoon_role/over_buy_request",{order_id:e}),k=t=>t.$axios.$get("cartoon_role/get_mine_product_orders"),C=(t,{idol_id:e,days:r})=>t.$axios.$get("cartoon_role/get_idol_days_chart",{params:{idol_id:e,days:r}})},195:function(t,e,r){"use strict";r.r(e);var n=r(176),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},196:function(t,e,r){t.exports=r.p+"img/1727dbb.png"},198:function(t,e,r){"use strict";r.r(e);var n=r(178),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},203:function(t,e,r){"use strict";var n=r(179),o=r(192),c={name:"FlowHeaderUser",components:{UserAvatar:n.a,UserNickname:o.a},props:{user:{type:Object,required:!0},time:{type:String,required:!0}}},l=r(1);var component=Object(l.a)(c,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"user-panel"},[r("UserAvatar",{attrs:{user:t.user}}),t._ssrNode(" "),t._ssrNode('<div class="slot">',"</div>",[t._t("default")],2),t._ssrNode(" "),t._ssrNode('<div class="user-info">',"</div>",[r("UserNickname",{attrs:{user:t.user}}),t._ssrNode(" "),r("VTime",{model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],2)],2)},[],!1,function(t){var e=r(198);e.__inject__&&e.__inject__(t)},null,"7d79de9c");e.a=component.exports},208:function(t,e,r){"use strict";r.r(e);var n=r(183),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},209:function(t,e,r){"use strict";r.r(e);var n=r(184),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},223:function(t,e,r){"use strict";var n={name:"BubbleTag",props:{icon:{type:String,default:""},text:{type:String,required:!0}}},o=r(1);var c={name:"FlowTags",components:{BubbleTag:Object(o.a)(n,function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",{class:t.$style.tag,on:{click:function(e){return t.$emit("click")}}},[t._t("icon"),t._ssrNode(" <span>"+t._ssrEscape(t._s(t.text))+"</span>")],2)},[],!1,function(t){var e=r(208);e.__inject__&&e.__inject__(t),this.$style=e.locals||e},null,"1c233d9a").exports},props:{bangumi:{type:Object,default:null},idol:{type:Object,default:null},tags:{type:Array,default:()=>[]}}};var l=Object(o.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"flow-tags"},[t.bangumi?n("BubbleTag",{attrs:{text:t.bangumi.name}},[n("img",{attrs:{slot:"icon",src:r(196)},slot:"icon"})]):t._e(),t._ssrNode(" "),t.idol?n("BubbleTag",{attrs:{text:t.idol.name}},[n("img",{attrs:{slot:"icon",src:r(196)},slot:"icon"})]):t._l(t.tags,function(t){return n("BubbleTag",{key:t.id,attrs:{text:t.name}})})],2)},[],!1,function(t){var e=r(209);e.__inject__&&e.__inject__(t)},null,"7d582408");e.a=l.exports},230:function(t,e){t.exports={"image-preview":"image-preview-2_",imagePreview:"image-preview-2_",container:"container-34",bar:"bar-1j","top-bar":"top-bar-1d",topBar:"top-bar-1d","foot-bar":"foot-bar-AF",footBar:"foot-bar-AF",wrap:"wrap-tx",item:"item-32",close:"close-27",download:"download-51","next-btn":"next-btn-3T",nextBtn:"next-btn-3T","prev-btn":"prev-btn-12",prevBtn:"prev-btn-12",rolling:"rolling-3m"}},254:function(t,e){},255:function(t,e){},271:function(t,e,r){"use strict";r.d(e,"b",function(){return n}),r.d(e,"a",function(){return o}),r.d(e,"c",function(){return c});const n=(t,{id:e,only:r,hash:n,time:time})=>t.$axios.$get(`post/${e}/show`,{params:{only:r,hash:n,time:time}}),o=(t,{title:title,bangumiId:e,content:content,images:r,tags:n,desc:desc,geetest:o,is_creator:c})=>t.$axios.$post("post/create",{title:title,bangumiId:e,content:content,images:r,tags:n,desc:desc,geetest:o,is_creator:c}),c=t=>t.$axios.$get("post/tags")},274:function(t,e,r){"use strict";r.r(e);var n=r(230),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},283:function(t,e,r){"use strict";var n={name:"ImagePreview",props:{images:{type:Array,default:()=>[]},query:{type:String,default:""},download:{type:Boolean,default:!0}},data(){return{show:!1,currentIndex:-1,maxWidth:0,maxHeight:0,displayImages:this.images.map(t=>Object.assign({finalWidth:0,finalHeight:0,loading:!0},t))}},computed:{total(){return this.images.length},currentImage(){return-1===this.currentIndex?null:this.displayImages[this.currentIndex]},isWechat(){return this.$store.state.ua.wechat}},mounted(){this.getScreenSize(),window.addEventListener("resize",this.getScreenSize)},methods:{handleClose(){this.show=!1},handleClick(t){if(this.isWechat)return;if(!this.total)return;const e=t.target,r="img"===e.tagName.toLowerCase();if(!this.query&&!r)return;if(this.query&&-1===e.className.indexOf(this.query))return;let n="";if(r)n=e.getAttribute("src").split("?")[0];else{const img=e.querySelector("img");if(!img)return;n=img.getAttribute("src").split("?")[0]}this.getClickImageIndex(n),this.computeDisplaySize(this.currentIndex),this.show=!0},getClickImageIndex(t){this.images.forEach((image,e)=>{image.url===t&&(this.currentIndex=e)})},getScreenSize(){this.maxWidth=window.innerWidth,this.maxHeight=window.innerHeight-88},switchImage(t){if(t&&this.currentIndex===this.total-1)return;if(!t&&0===this.currentIndex)return;const e=t?this.currentIndex+1:this.currentIndex-1;this.computeDisplaySize(e),this.currentIndex=e},getSiblingsIndex(t){let e,r;return 0===this.currentIndex?(e=this.total-1,r=1):this.currentIndex===this.total-1?(e=this.total-2,r=0):(e=this.currentIndex-1,r=this.currentIndex+1),[e,t,r]},computeDisplaySize(t){if(void 0===this.images[t])return;const image=this.images[t];if(image.finalWidth&&image.finalHeight)return;const e=image.width,r=image.height,n=this.maxWidth,o=this.maxHeight;let c,l;if(n>=e&&o>=r)c=e,l=r;else if(n<e&&o<r){const t=e/o,d=r/o;t>=d?(c=n,l=parseInt(r/t,10)):(c=parseInt(e/d,10),l=o)}else if(r<o){c=n,l=parseInt(r/(e/o),10)}else{c=parseInt(e/(r/o),10),l=o}this.displayImages[t].finalWidth=c||n,this.displayImages[t].finalHeight=l||o},handleSwitch(t,e){this.currentIndex=e}}},o=r(1);var component=Object(o.a)(n,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{class:t.$style.imagePreview,on:{click:t.handleClick}},[t._ssrNode((t.show?"<div"+t._ssrClass(null,t.$style.container)+"><div"+t._ssrClass(null,[t.$style.bar,t.$style.topBar])+">"+(t.total?"<span"+t._ssrClass(null,t.$style.total)+">"+t._ssrEscape("\n        "+t._s(t.currentIndex+1)+"/"+t._s(t.total)+"\n      ")+"</span>":"\x3c!----\x3e")+" <span"+t._ssrClass(null,t.$style.close)+"> × </span></div> <div"+t._ssrClass(null,[t.$style.bar,t.$style.footBar])+">"+(t.currentImage&&t.download?"<a"+t._ssrAttr("href",t.currentImage.url)+' target="_blank"'+t._ssrClass(null,t.$style.download)+">\n        下载原图\n      </a>":"\x3c!----\x3e")+"</div> "+(t.currentImage?"<div"+t._ssrClass(null,t.$style.wrap)+"><div"+t._ssrClass(null,t.$style.item)+t._ssrStyle(null,{backgroundImage:"url("+t.$resize(t.currentImage.url,{webP:!t.download})+")",width:""+t.$px2vw(t.currentImage.finalWidth),height:""+t.$px2vw(t.currentImage.finalHeight)},null)+"></div> "+(t.total>1?"<button"+t._ssrClass(null,t.$style.prevBtn)+'><i class="el-icon-caret-left"></i></button> <button'+t._ssrClass(null,t.$style.nextBtn)+'><i class="el-icon-caret-right"></i></button>':"\x3c!----\x3e")+"</div>":"\x3c!----\x3e")+"</div>":"\x3c!----\x3e")+" "),t._t("default")],2)},[],!1,function(t){var e=r(274);e.__inject__&&e.__inject__(t),this.$style=e.locals||e},null,"c07ef6ca");e.a=component.exports},307:function(t,e){},308:function(t,e,r){"use strict";r.r(e);var n=r(254),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},309:function(t,e,r){"use strict";r.r(e);var n=r(255),o=r.n(n);for(var c in n)"default"!==c&&function(t){r.d(e,t,function(){return n[t]})}(c);e.default=o.a},375:function(t,e,r){"use strict";var n=r(283),o=(r(86),r(2),r(43)),c=r.n(o),l=(r(307),r(154)),d=r.n(l),_=r(193),f={name:"BuyContentBtn",components:{"mt-spinner":d.a,"el-input-number":c.a},props:{id:{type:[String,Number],required:!0},title:{type:String,required:!0},author:{type:String,required:!0},type:{type:String,required:!0}},data:()=>({show:!1,idol:null,price:5,submitting:!1}),methods:{async showBuyModal(){this.show=!0,this.idol=await Object(_.j)(this)},async submitAction(){if(this.price<5)this.$toast.error("不支持5团子以下的采购");else if(this.price>this.idol.income)this.$toast.error("没有足够的资金");else if(!this.submitting&&this.idol){this.submitting=!0;try{await Object(_.d)(this,{product_id:this.id,product_type:this.type,amount:this.price}),this.show=!1,this.$toast.success("请求已发送，等待作者确认")}catch(t){this.$toast.error(t)}finally{this.submitting=!1}}}}},m=r(1);var h=Object(m.a)(f,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("span",{staticClass:"buy-content-btn-wrap"},[t._ssrNode('<button class="buy-content-btn">\n    采购\n  </button> '),r("v-drawer",{attrs:{"header-text":"内容采购","submit-text":"确认",from:"bottom",size:"70%"},on:{submit:t.submitAction},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[r("div",{staticClass:"container"},[t.idol?[r("p",[t._v("\n          以「"+t._s(t.idol.name)+"」经纪人的身份，采购「"+t._s(t.author)+"」的文章《"+t._s(t.title)+"》\n        ")]),t._v(" "),r("br"),t._v(" "),r("p",[t._v("当前可用资金：￥"+t._s(t.idol.income))]),t._v(" "),r("div",[r("br"),t._v(" "),r("p",[r("strong",[t._v("采购价格：")])]),t._v(" "),r("br"),t._v(" "),r("el-input-number",{attrs:{min:5,max:t.idol.income>35?35:t.idol.income},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}})],1),t._v(" "),r("div",[r("br"),t._v(" "),r("p",[r("strong",[t._v("分成比例：")])]),t._v(" "),r("br"),t._v(" "),r("p",[t._v("\n            当前默认的分成比例是\n            5：5（该文章每收到一次投食，就有0.5个团子赠予偶像，0.5个团子归属作者）\n          ")])]),t._v(" "),r("div",[r("br"),t._v(" "),r("p",[r("strong",[t._v("提示：")])]),t._v(" "),r("br"),t._v(" "),r("p",[t._v("\n            确认采购后，等待作者确认，作者同意后才会扣费，并开始计算偶像的盈利\n          ")])]),t._v(" "),r("br")]:r("div",{staticStyle:{"text-align":"center"}},[r("br"),t._v(" "),r("br"),t._v(" "),r("mt-spinner",{attrs:{type:"triple-bounce"}})],1)],2)])],2)},[],!1,function(t){var e=r(308);e.__inject__&&e.__inject__(t)},null,"5c37effc").exports,v=r(203),x=r(223),$={name:"PostContent",components:{ImagePreview:n.a,BuyContentBtn:h,FlowHeaderUser:v.a,FlowTags:x.a},props:{post:{type:Object,required:!0},user:{type:Object,required:!0},bangumi:{type:Object,required:!0}}};var y=Object(m.a)($,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"post-content"}},[t._ssrNode('<div class="container">',"</div>",[t._ssrNode('<h1 class="title">'+(t.post.is_nice?'<div class="nice_badge">\n        精\n      </div>':"\x3c!----\x3e")+t._ssrEscape("\n      "+t._s(t.post.title)+"\n    ")+"</h1> "),r("FlowHeaderUser",{attrs:{user:t.user,time:t.post.created_at}},[!t.post.idol&&t.post.is_idol_manager&&t.post.is_creator?r("BuyContentBtn",{attrs:{id:t.post.id,title:t.post.title,author:t.user.nickname,type:"post"}}):t._e()],1),t._ssrNode(" "),t._ssrNode('<div class="content">',"</div>",[r("ImagePreview",{staticClass:"image-area",attrs:{images:t.post.images}},t._l(t.post.images,function(img,t){return r("div",{key:t,staticClass:"image-package"},[r("v-img",{attrs:{src:img.url,full:!0,width:img.width,height:img.height}})],1)}),0),t._ssrNode(' <div class="text-area">'+t._s(t.post.content)+"</div>")],2),t._ssrNode(" "),r("FlowTags",{attrs:{bangumi:t.bangumi,idol:t.post.idol,tags:t.post.tags}})],2)])},[],!1,function(t){var e=r(309);e.__inject__&&e.__inject__(t)},null,"13064e1a");e.a=y.exports},503:function(t,e,r){"use strict";r.r(e);var n=r(271),o={name:"WxAppPost",components:{PostContent:r(375).a},data:()=>({post:null,user:null,bangumi:null}),asyncData({store:t,params:e,app:r,error:o}){const{id:c}=e;return Object(n.b)(r,{id:c,only:0}).then(data=>{const{post:e,bangumi:r}=data;return t.commit("social/SET_STATE",{type:"post",id:c,data:{like:e.liked,reward:e.rewarded,mark:e.marked,like_users:e.like_users,mark_users:e.mark_users,reward_users:e.reward_users}}),t.commit("social/SET_STATE",{type:"bangumi",id:r.id,data:{follow:r.followed}}),{post:e,bangumi:r,user:data.user}}).catch(t=>{o({statusCode:t.statusCode,message:t.message})})}},c=r(1);var component=Object(c.a)(o,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"wx-app-post"}},[e("PostContent",{attrs:{post:this.post,user:this.user,bangumi:this.bangumi}})],1)},[],!1,function(t){},null,"e9d9831e");e.default=component.exports}};
//# sourceMappingURL=_id.chunk.fe4de554.js.map