exports.ids=[65],exports.modules={171:function(t,e){},172:function(t,e,o){t.exports=o.p+"img/aa8b45a.png"},173:function(t,e,o){"use strict";var r=o(4),n={name:"FlowState",props:{auto:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},noMore:{type:Boolean,default:!1},nothing:{type:Boolean,default:!1},error:{type:Boolean,default:!1},fetch:{type:Function,required:!0},displayNoMore:{type:Boolean,default:!0}},mounted(){this.auto&&this.onScroll()},methods:{getTarget(){let t=this.$el;for(;"HTML"!==t.tagName&&"BOYD"!==t.tagName&&1===t.nodeType;){const e=window.getComputedStyle(t).overflowY;if("scroll"===e||"auto"===e)return t;t=t.parentNode}return document},onScroll(){if(this.error)return;r.a.checkInView(this.$el)&&this.fetch();const t=r.a.on(this.getTarget(),["scroll"],this.$utils.throttle(()=>{this.error||(!this.noMore&&this.auto?r.a.checkInView(this.$el)&&this.fetch():r.a.off(t))},200))}}},d=o(1);var component=Object(d.a)(n,function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"flow-state-wrap"},[t.error?t._ssrNode("<div>","</div>",[t._t("error",[r("div",{staticClass:"state-error"},[r("span",[t._v("出错了，点击重试")])])])],2):t.nothing?t._ssrNode("<div>","</div>",[t._t("nothing",[r("div",{staticClass:"state-nothing"},[r("img",{attrs:{src:o(172),alt:"no-content"}}),t._v(" "),r("span",[t._v("这里什么都没有")])])])],2):t.noMore?t._ssrNode("<div>","</div>",[t._t("no-more",[t.displayNoMore?r("div",{staticClass:"state-no-more"},[r("span",[t._v("没有更多了")])]):t._e()])],2):t.loading?t._ssrNode("<div>","</div>",[t._t("loading",[r("div",{staticClass:"state-loading"},[r("i"),t._v(" "),r("span",[t._v("加载中…")])])])],2):t.auto?t._ssrNode('<div class="state-shim"></div>'):t._ssrNode("<button>","</button>",[t._t("load-btn",[r("div",{staticClass:"state-fetch-btn-text"},[r("span",[t._v("点击加载更多")])])])],2)])},[],!1,function(t){var e=o(175);e.__inject__&&e.__inject__(t)},null,"16540fb2");e.a=component.exports},175:function(t,e,o){"use strict";o.r(e);var r=o(171),n=o.n(r);for(var d in r)"default"!==d&&function(t){o.d(e,t,function(){return r[t]})}(d);e.default=n.a},177:function(t,e,o){"use strict";var r=o(173),n={props:{func:{required:!0,type:String},type:{required:!0,type:String},id:{type:[Number,String],default:""},sort:{type:String,default:""},auto:{type:Boolean,default:!0},count:{type:[String,Number],default:12},changing:{type:String,default:"id"},displayNoMore:{type:Boolean,default:!0}}},d={name:"FlowList",components:{FlowState:r.a},mixins:[n],computed:{source(){return this.$store.getters["flow/getFlow"](this.func,this.sort,this.id)}},methods:{loadMore(){this.$store.dispatch("flow/loadMore",{type:this.type,sort:this.sort,func:this.func,id:this.id,count:this.count,changing:this.changing,_extra:this.extra})}}},c=o(1),component=Object(c.a)(d,function(){var t=this,e=t.$createElement,o=t._self._c||e;return t.source?o("div",[t._t("header",null,{source:t.source}),t._ssrNode(" "),t._t("default",null,{flow:t.source.list}),t._ssrNode(" "),o("FlowState",{attrs:{auto:t.auto,loading:t.source.loading,"no-more":t.source.noMore,nothing:t.source.nothing,error:t.source.error,"display-no-more":t.displayNoMore,fetch:t.loadMore}},[t._t("error",null,{slot:"error"}),t._v(" "),t._t("nothing",null,{slot:"nothing"}),t._v(" "),t._t("no-more",null,{slot:"no-more"}),t._v(" "),t._t("loading",null,{slot:"loading"}),t._v(" "),t._t("load-btn",null,{slot:"load-btn"})],2)],2):t._e()},[],!1,null,null,"0bee53e6");e.a=component.exports},193:function(t,e,o){"use strict";o.d(e,"i",function(){return r}),o.d(e,"r",function(){return n}),o.d(e,"h",function(){return d}),o.d(e,"c",function(){return c}),o.d(e,"o",function(){return l}),o.d(e,"f",function(){return _}),o.d(e,"m",function(){return f}),o.d(e,"e",function(){return h}),o.d(e,"p",function(){return m}),o.d(e,"a",function(){return v}),o.d(e,"n",function(){return $}),o.d(e,"j",function(){return y}),o.d(e,"d",function(){return x}),o.d(e,"b",function(){return w}),o.d(e,"g",function(){return N}),o.d(e,"q",function(){return O}),o.d(e,"l",function(){return k}),o.d(e,"k",function(){return C});const r=(t,{id:e})=>t.$axios.$get(`cartoon_role/${e}/stock_show`),n=(t,{id:e,amount:o})=>t.$axios.$post(`cartoon_role/${e}/buy_stock`,{amount:o}),d=(t,{id:e})=>t.$axios.$get(`cartoon_role/${e}/get_idol_deal`),c=(t,form)=>t.$axios.$post("cartoon_role/create_deal",form),l=(t,form)=>t.$axios.$post("cartoon_role/make_deal",form),_=(t,{id:e})=>t.$axios.$post("cartoon_role/delete_deal",{id:e}),f=t=>t.$axios.$get("cartoon_role/stock_meta"),h=(t,form)=>t.$axios.$post("cartoon_role/create_market_price_draft",form),m=(t,{is_agree:e,idol_id:o,draft_id:r})=>t.$axios.$post("cartoon_role/vote_market_price_draft",{is_agree:e,idol_id:o,draft_id:r}),v=(t,{idol_id:e,qq_group:o,lover_words:r,manager_id:n})=>t.$axios.$post("cartoon_role/change_idol_profile",{idol_id:e,qq_group:o,lover_words:r,manager_id:n}),$=t=>t.$axios.$get("cartoon_role/user_draft_work"),y=t=>t.$axios.$get("cartoon_role/can_use_income"),x=(t,{product_id:e,product_type:o,amount:r})=>t.$axios.$post("cartoon_role/create_buy_request",{product_id:e,product_type:o,amount:r}),w=(t,{order_id:e,result:o})=>t.$axios.$post("cartoon_role/check_product_request",{order_id:e,result:o}),N=(t,{order_id:e})=>t.$axios.$post("cartoon_role/delete_buy_request",{order_id:e}),O=(t,{order_id:e})=>t.$axios.$post("cartoon_role/over_buy_request",{order_id:e}),k=t=>t.$axios.$get("cartoon_role/get_mine_product_orders"),C=(t,{idol_id:e,days:o})=>t.$axios.$get("cartoon_role/get_idol_days_chart",{params:{idol_id:e,days:o}})},211:function(t,e){},258:function(t,e){},314:function(t,e,o){"use strict";o.r(e);var r=o(258),n=o.n(r);for(var d in r)"default"!==d&&function(t){o.d(e,t,function(){return r[t]})}(d);e.default=n.a},377:function(t,e,o){"use strict";var r=o(177),n=(o(211),o(2),o(148)),d=o.n(n),c=o(193),l={name:"IdolOrderItem",components:{"el-tag":d.a},props:{item:{type:Object,required:!0}},data(){return{loading:!1,state:this.item.result}},computed:{isMine(){return!!this.$store.state.login&&this.$store.state.user.zone===this.item.buyer.zone},computeTagColor(){const t=this.state;return 0===t?"":1===t?"success":2===t?"danger":3===t?"info":4===t?"warning":5===t?"info":6===t?"danger":""},computedResult(){const t=this.state;return 0===t?"等待作者确认":1===t?"已采购成功":2===t?"作者已拒绝":3===t?"订单已取消":4===t?"作品已出售":5===t?"作品已失效":6===t?"经纪人解约":"未知状态"}},methods:{cancelOrder(t){this.loading||this.$confirm("确认执行该操作吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{this.loading=!0,await Object(c.g)(this,{order_id:t}),this.$toast.success("订单已取消"),this.state=3}catch(t){this.$toast.error(t)}finally{this.loading=!1}}).catch()},rollbackOrder(t){this.loading||this.$confirm("终止后无法得到收益分成，也不会退还定金，确认要这么做吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{this.loading=!0,await Object(c.q)(this,{order_id:t}),this.$toast.success("订单已解约"),this.state=6}catch(t){this.$toast.error(t)}finally{this.loading=!1}}).catch()}}},_=o(1);var f=Object(_.a)(l,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("li",{staticClass:"idol-order-item"},[t._ssrNode('<div class="header">',"</div>",[o("nuxt-link",{staticClass:"avatar",attrs:{to:t.$alias.user(t.item.buyer.zone)}},[o("img",{attrs:{src:t.$resize(t.item.buyer.avatar,{width:80})}})]),t._ssrNode(" "),t._ssrNode('<div class="info">',"</div>",[o("nuxt-link",{staticClass:"name oneline",attrs:{to:t.$alias.post(t.item.product.id)},domProps:{textContent:t._s(t.item.product.title)}}),t._ssrNode(' <div class="meta"><span>采购帖子</span></div>')],2)],2),t._ssrNode(" "),o("nuxt-link",{staticClass:"body",attrs:{to:t.$alias.post(t.item.product.id)}},[o("p",{staticClass:"intro"},[t._v("\n      订单详情：\n    ")]),t._v(" "),o("p",[t._v("价格：￥"+t._s(t.item.amount))]),t._v(" "),o("p",[t._v("分成：偶像占"+t._s(t.item.income_ratio)+"%")]),t._v(" "),o("p",[t._v("\n      状态："),o("el-tag",{attrs:{size:"mini",type:t.computeTagColor}},[t._v("\n        "+t._s(t.computedResult)+"\n      ")])],1)]),t._ssrNode(' <div class="footer"><span>'+t._ssrEscape("时间："+t._s(t.item.created_at.split(" ")[0]))+"</span> "+(t.isMine?(0===t.state?"<button>\n        取消订单\n      </button>":"\x3c!----\x3e")+" "+(1===t.state?"<button>\n        终止订单\n      </button>":"\x3c!----\x3e"):"\x3c!----\x3e")+"</div>")],2)},[],!1,function(t){var e=o(314);e.__inject__&&e.__inject__(t)},null,"6111d03c").exports,h={name:"IdolProductOrderList",components:{FlowList:r.a,IdolOrderItem:f},props:{idolId:{type:String,required:!0}}};var m=Object(_.a)(h,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"idol-product-order-list"},[o("FlowList",{attrs:{id:t.idolId,func:"getIdolProductOrders",type:"page",sort:"news"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.flow;return o("ul",{},t._l(r,function(t){return o("IdolOrderItem",{key:t.id,attrs:{item:t}})}),1)}}])})],1)},[],!1,function(t){},null,"5ca2de8c");e.a=m.exports},489:function(t,e,o){"use strict";o.r(e);var r={name:"WxAppIdolBuy",components:{IdolProductOrderList:o(377).a},async fetch({store:t,params:e}){await t.dispatch("flow/initData",{func:"getIdolProductOrders",type:"page",sort:"news",id:e.id})}},n=o(1);var component=Object(n.a)(r,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"wx-app-idol-buy"}},[this._ssrNode('<div class="container">',"</div>",[e("IdolProductOrderList",{attrs:{"idol-id":this.$route.params.id}})],1)])},[],!1,function(t){},null,"7d97b600");e.default=component.exports}};
//# sourceMappingURL=buy.chunk.2041466c.js.map