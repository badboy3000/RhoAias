exports.ids=[33],exports.modules={171:function(t,e){},172:function(t,e,n){t.exports=n.p+"img/aa8b45a.png"},173:function(t,e,n){"use strict";var o=n(4),r={name:"FlowState",props:{auto:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},noMore:{type:Boolean,default:!1},nothing:{type:Boolean,default:!1},error:{type:Boolean,default:!1},fetch:{type:Function,required:!0},displayNoMore:{type:Boolean,default:!0}},mounted(){this.auto&&this.onScroll()},methods:{getTarget(){let t=this.$el;for(;"HTML"!==t.tagName&&"BOYD"!==t.tagName&&1===t.nodeType;){const e=window.getComputedStyle(t).overflowY;if("scroll"===e||"auto"===e)return t;t=t.parentNode}return document},onScroll(){if(this.error)return;o.a.checkInView(this.$el)&&this.fetch();const t=o.a.on(this.getTarget(),["scroll"],this.$utils.throttle(()=>{this.error||(!this.noMore&&this.auto?o.a.checkInView(this.$el)&&this.fetch():o.a.off(t))},200))}}},c=n(1);var component=Object(c.a)(r,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"flow-state-wrap"},[t.error?t._ssrNode("<div>","</div>",[t._t("error",[o("div",{staticClass:"state-error"},[o("span",[t._v("出错了，点击重试")])])])],2):t.nothing?t._ssrNode("<div>","</div>",[t._t("nothing",[o("div",{staticClass:"state-nothing"},[o("img",{attrs:{src:n(172),alt:"no-content"}}),t._v(" "),o("span",[t._v("这里什么都没有")])])])],2):t.noMore?t._ssrNode("<div>","</div>",[t._t("no-more",[t.displayNoMore?o("div",{staticClass:"state-no-more"},[o("span",[t._v("没有更多了")])]):t._e()])],2):t.loading?t._ssrNode("<div>","</div>",[t._t("loading",[o("div",{staticClass:"state-loading"},[o("i"),t._v(" "),o("span",[t._v("加载中…")])])])],2):t.auto?t._ssrNode('<div class="state-shim"></div>'):t._ssrNode("<button>","</button>",[t._t("load-btn",[o("div",{staticClass:"state-fetch-btn-text"},[o("span",[t._v("点击加载更多")])])])],2)])},[],!1,function(t){var e=n(175);e.__inject__&&e.__inject__(t)},null,"16540fb2");e.a=component.exports},174:function(t,e){},175:function(t,e,n){"use strict";n.r(e);var o=n(171),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},176:function(t,e){},177:function(t,e,n){"use strict";var o=n(173),r={props:{func:{required:!0,type:String},type:{required:!0,type:String},id:{type:[Number,String],default:""},sort:{type:String,default:""},auto:{type:Boolean,default:!0},count:{type:[String,Number],default:12},changing:{type:String,default:"id"},displayNoMore:{type:Boolean,default:!0}}},c={name:"FlowList",components:{FlowState:o.a},mixins:[r],computed:{source(){return this.$store.getters["flow/getFlow"](this.func,this.sort,this.id)}},methods:{loadMore(){this.$store.dispatch("flow/loadMore",{type:this.type,sort:this.sort,func:this.func,id:this.id,count:this.count,changing:this.changing,_extra:this.extra})}}},l=n(1),component=Object(l.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.source?n("div",[t._t("header",null,{source:t.source}),t._ssrNode(" "),t._t("default",null,{flow:t.source.list}),t._ssrNode(" "),n("FlowState",{attrs:{auto:t.auto,loading:t.source.loading,"no-more":t.source.noMore,nothing:t.source.nothing,error:t.source.error,"display-no-more":t.displayNoMore,fetch:t.loadMore}},[t._t("error",null,{slot:"error"}),t._v(" "),t._t("nothing",null,{slot:"nothing"}),t._v(" "),t._t("no-more",null,{slot:"no-more"}),t._v(" "),t._t("loading",null,{slot:"loading"}),t._v(" "),t._t("load-btn",null,{slot:"load-btn"})],2)],2):t._e()},[],!1,null,null,"0bee53e6");e.a=component.exports},179:function(t,e,n){"use strict";var o={name:"UserAvatar",props:{user:{type:Object,required:!0},size:{type:Number,default:40}},methods:{toUser(){this.$router.push(this.$alias.user(this.user.zone))}}},r=n(1);var component=Object(r.a)(o,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"user-avatar",style:{width:t.$px2vw(t.size),height:t.$px2vw(t.size)},on:{click:function(e){return e.stopPropagation(),t.toUser(e)}}},[t._ssrNode("<img"+t._ssrAttr("src",t.$resize(t.user.avatar,{width:2*t.size}))+">")])},[],!1,function(t){var e=n(181);e.__inject__&&e.__inject__(t)},null,"16ffe9a8");e.a=component.exports},181:function(t,e,n){"use strict";n.r(e);var o=n(174),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},185:function(t,e){},186:function(t,e){},187:function(t,e){t.exports={item:"item-1M","in-detail":"in-detail-3X",inDetail:"in-detail-3X",avatar:"avatar-1i",main:"main-1x",header:"header-1Z",nickname:"nickname-JF","to-user":"to-user-2r",toUser:"to-user-2r",content:"content-1g",rolling:"rolling-1u"}},188:function(t,e){},189:function(t,e){},190:function(t,e){},191:function(t,e){},192:function(t,e,n){"use strict";var o={name:"UserNickname",props:{user:{type:Object,required:!0},isMaster:{type:Boolean,default:!1}},methods:{toUser(){this.$router.push(this.$alias.user(this.user.zone))}}},r=n(1);var component=Object(r.a)(o,function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"user-nickname"},[this._ssrNode('<div class="nickname"><p class="oneline">'+this._ssrEscape(this._s(this.user.nickname))+"</p></div> "+(this.isMaster?'<span class="badge master-badge"><span>楼主</span></span>':"\x3c!----\x3e"))])},[],!1,function(t){var e=n(195);e.__inject__&&e.__inject__(t)},null,"0ad68c7d");e.a=component.exports},194:function(t,e,n){"use strict";e.a=((t,e,n,o)=>{let r=0;const element=n?[n]:[document.getElementsByTagName("html")[0],document.body],c=n?n.scrollTop:window.scrollY,l=t||0,m=e||2e3,d=o||"easeOutSine",time=Math.max(.1,Math.min(Math.abs(c-l)/m,.8)),h={easeOutSine:t=>Math.sin(t*(Math.PI/2)),easeInOutSine:t=>-.5*(Math.cos(Math.PI*t)-1),easeInOutQuint:t=>(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)};element.forEach(t=>{t.requestAnimFrame||(t.requestAnimFrame=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}).bind(window))}),function t(){const p=(r+=1/60)/time,e=h[d](p);element.forEach(n=>{p<1?(n.requestAnimFrame(t),n.scrollTop=c+(l-c)*e):n.scrollTop=l})}()})},195:function(t,e,n){"use strict";n.r(e);var o=n(176),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},199:function(t,e){},200:function(t,e){},206:function(t,e,n){"use strict";var o=n(194),r={name:"CommentCreateForm",props:{type:{required:!0,type:String},id:{required:!0,type:[Number,String]},masterId:{required:!0,type:Number}},data:()=>({content:""}),computed:{isGuest(){return!this.$store.state.login},submitting(){return this.$store.state.comment.submitting}},methods:{async submit(){if(this.isGuest)this.$channel.$emit("sign-in");else if(this.content){if(!this.submitting){this.$store.commit("comment/SET_SUBMITTING",{result:!0});try{const t=await this.$store.dispatch("comment/createMainComment",{content:this.content,images:[],type:this.type,id:this.id,ctx:this});this.$toast.success(t.message),this.$store.commit("UPDATE_USER_EXP",t.exp),this.$emit("submit"),this.content="",setTimeout(()=>{const e=document.getElementById(`comment-${t.data.id}`);e&&Object(o.a)(this.$utils.getOffsetTop(e)-100,600)},400)}finally{this.$store.commit("comment/SET_SUBMITTING",{result:!1})}}}else this.$emit("close")},handleAreaFocus(){document.body.scrollTop=0}}},c=n(1);var l=Object(c.a)(r,function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"comment-create-form"},[this._ssrNode('<textarea placeholder="来吧，尽情的（在1000字以内）发挥吧" maxlength="1000" class="content"></textarea> '),e("el-button",{staticClass:"submit-btn",attrs:{loading:this.submitting,type:"primary"},on:{click:this.submit}},[this._v("\n    发布\n  ")])],2)},[],!1,function(t){var e=n(213);e.__inject__&&e.__inject__(t)},null,"8222d2d8").exports,m={name:"SubCommentItem",props:{comment:{required:!0,type:Object},parentUserId:{required:!0,type:Number},parentCommentId:{required:!0,type:Number},type:{required:!0,type:String}},data:()=>({deleting:!1}),computed:{currentUserId(){return this.$store.state.login?this.$store.state.user.id:0},isMine(){return this.currentUserId===this.comment.from_user_id},showToUser(){return this.comment.to_user_id&&this.comment.to_user_id!==this.parentUserId},canDelete(){return this.isMine||this.currentUserId===this.parentUserId}},methods:{handleSubCommentClick(){if(this.isMine)return this.deleteComment(),void this.$nextTick(()=>{document.getElementById("reply-comment-textarea").style.display="none"});this.currentUserId&&this.$channel.$emit("reply-comment",{id:this.parentCommentId,targetUserId:this.comment.from_user_id,targetUserName:this.comment.from_user_name})},deleteComment(){this.canDelete&&(this.deleting||(this.deleting=!0,this.$confirm("删除后无法找回, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$store.dispatch("comment/deleteSubComment",{ctx:this,type:this.type,id:this.comment.id,parentId:this.comment.parent_id})}).catch(()=>{this.deleting=!1})))}}};var d={name:"PostSubCommentList",components:{SubCommentItem:Object(c.a)(m,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.$style.item},[n("nuxt-link",{class:t.$style.avatar,attrs:{to:t.$alias.user(t.comment.from_user_zone),tag:"div"}},[n("VImg",{attrs:{src:t.comment.from_user_avatar,width:22,height:22,avatar:!0}})],1),t._ssrNode(" "),t._ssrNode("<div"+t._ssrClass(null,t.$style.main)+">","</div>",[t._ssrNode("<div"+t._ssrClass("oneline",t.$style.header)+">","</div>",[t.showToUser?[n("nuxt-link",{class:t.$style.nickname,attrs:{to:t.$alias.user(t.comment.from_user_zone),tag:"span"}},[t._v("\n          "+t._s(t.comment.from_user_name)+":\n        ")]),t._ssrNode(" "),n("nuxt-link",{class:t.$style.toUser,attrs:{to:t.$alias.user(t.comment.to_user_zone),tag:"span"}},[t._v("\n          @"+t._s(t.comment.to_user_name)+"\n        ")])]:n("nuxt-link",{class:t.$style.nickname,attrs:{to:t.$alias.user(t.comment.from_user_zone),tag:"span"},domProps:{textContent:t._s(t.comment.from_user_name)}})],2),t._ssrNode(" <p"+t._ssrClass(null,t.$style.content)+">"+t._ssrEscape(t._s(t.comment.content))+"</p>")],2)],2)},[],!1,function(t){var e=n(215);e.__inject__&&e.__inject__(t);var o=n(216);o.__inject__&&o.__inject__(t),this.$style=o.locals||o},null,"40f00e8d").exports},props:{parentComment:{required:!0,type:Object},type:{required:!0,type:String}},computed:{comments(){return this.parentComment.comments},authorId(){return this.parentComment.from_user_id},hasComment(){return!!this.comments.list.length},filterComments(){const data=this.comments,t=data.list,e=t.slice(0,2);if(t.every(t=>t.id<=data.maxId))return e;const n=e.map(t=>t.id);return e.concat(t.filter(t=>t.id>data.maxId&&-1===n.indexOf(t.id)))}},methods:{loadAllComment(){this.$channel.$emit("load-all-sub-comment",{id:this.parentComment.id})}}};var h=Object(c.a)(d,function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.hasComment?n("div",{staticClass:"sub-comment-list-wrap"},[t._ssrNode('<div class="sub-comment-list">',"</div>",[t._l(t.filterComments,function(e){return n("SubCommentItem",{key:e.id,attrs:{comment:e,"parent-user-id":t.authorId,"parent-comment-id":t.parentComment.id,type:t.type}})}),t._ssrNode(" "+(!t.comments.noMore||t.comments.list.length>2?'<button class="load-all-comment">'+t._ssrEscape("\n      全部"+t._s(t.comments.total)+"条回复\n    ")+"</button>":"\x3c!----\x3e"))],2)]):t._e()},[],!1,function(t){var e=n(217);e.__inject__&&e.__inject__(t)},null,"4af58698").exports,_=n(179),f=n(192),v={name:"CommentCommentItem",components:{SubCommentList:h,UserAvatar:_.a,UserNickname:f.a},props:{comment:{required:!0,type:Object},masterId:{required:!0,type:Number},type:{required:!0,type:String}},data:()=>({deleting:!1,liking:!1}),computed:{currentUserId(){return this.$store.state.login?this.$store.state.user.id:0},isMine(){return this.currentUserId===this.comment.from_user_id},canDelete(){return this.isMine||this.currentUserId===this.masterId},computeFromUser(){return{id:this.comment.from_user_id,avatar:this.comment.from_user_avatar,nickname:this.comment.from_user_name,zone:this.comment.from_user_zone}},imageCount(){return this.comment.images.length},filterImages(){return this.inDetail?this.comment.images:this.comment.images.slice(0,3)}},methods:{async toggleLike(){if(this.currentUserId){if(!this.liking){this.liking=!0;try{await this.$store.dispatch("comment/toggleLikeMainComment",{ctx:this,type:this.type,id:this.comment.id})}finally{this.liking=!1}}}else this.$channel.$emit("sign-in")},deleteComment(){this.deleting||(this.deleting=!0,this.$confirm("删除后无法找回, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$store.dispatch("comment/deleteMainComment",{ctx:this,type:this.type,id:this.comment.id}),this.$emit("delete")}).catch(()=>{this.deleting=!1}))},handleCommentBtnClick(){this.$channel.$emit("reply-comment",{id:this.comment.id,targetUserId:this.computeFromUser.id,targetUserName:this.computeFromUser.nickname})}}};var w={name:"VCommentMain",components:{CommentCreateForm:l,CommentItem:Object(c.a)(v,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"comment-item"},[t._ssrNode('<div class="avatar">',"</div>",[o("UserAvatar",{attrs:{size:35,user:t.computeFromUser}})],1),t._ssrNode(" "),t._ssrNode('<div class="content">',"</div>",[t._ssrNode('<div class="header">',"</div>",[t._ssrNode('<div class="right-btn">'+(t.canDelete?'<div class="tool-btn-wrap"><button><img'+t._ssrAttr("src",n(214))+"></button></div>":"\x3c!----\x3e")+"</div> "),o("UserNickname",{attrs:{user:t.computeFromUser,"is-master":t.comment.is_owner}})],2),t._ssrNode(" "),t._ssrNode('<div class="main">',"</div>",[t._ssrNode('<div class="text-area">'+t._s(t.comment.content)+"</div> "),t.imageCount?t._ssrNode('<div class="image-area">',"</div>",[1===t.imageCount?t._ssrNode("<div>","</div>",t._l(t.comment.images,function(t,e){return o("VImg",{key:e,staticClass:"image",attrs:{src:t.url,size:t.size,type:t.type,blur:!0,height:98,width:"auto"}})}),1):t._ssrNode("<div>","</div>",[t._ssrNode("<div>","</div>",t._l(t.filterImages,function(t,e){return o("VImg",{key:e,staticClass:"image",attrs:{src:t.url,size:t.size,type:t.type,blur:!0,width:"32%"}})}),1),t._ssrNode(" "+(t.imageCount>3?'<div class="mask"><span>'+t._ssrEscape("共"+t._s(t.imageCount)+"张图片")+"</span></div>":"\x3c!----\x3e"))],2)]):t._e()],2),t._ssrNode(" "),t._t("extra"),t._ssrNode(" "),t._ssrNode('<div class="footer">',"</div>",[t._ssrNode('<div class="info">',"</div>",[t._ssrNode("<span>"+t._ssrEscape(t._s(t.comment.floor_count)+"楼")+"</span> "),o("VTime",{model:{value:t.comment.created_at,callback:function(e){t.$set(t.comment,"created_at",e)},expression:"comment.created_at"}})],2),t._ssrNode(' <div class="social"><button'+t._ssrClass(null,{"is-active":t.comment.liked})+">"+(t.comment.like_count?"<span>"+t._ssrEscape(t._s(t.$utils.shortenNumber(t.comment.like_count)))+"</span>":"\x3c!----\x3e")+' <i class="iconfont icon-icon_good"></i></button></div>')],2),t._ssrNode(" "),o("SubCommentList",{attrs:{"parent-comment":t.comment,type:t.type}})],2)],2)},[],!1,function(t){var e=n(218);e.__inject__&&e.__inject__(t)},null,"6daa4147").exports,FlowState:n(173).a},props:{id:{required:!0,type:[Number,String]},type:{required:!0,type:String,validator:t=>~["post","video","image","score","question","answer","role"].indexOf(t)},onlySeeMaster:{type:Boolean,default:!1},masterId:{required:!0,type:Number},bottomAppendComment:{type:Boolean,default:!0},auto:{type:Boolean,default:!1},lazy:{type:Boolean,default:!0}},data:()=>({loadingMainComment:!1,focusCommentId:0,openFocusCommentDrawer:!1,loadingSubComment:!1,replyForm:{id:"",content:"",targetUserId:0,targetUserName:"",open:!1,replying:!1,liking:!1},openCreateCommentDrawer:!1,lastScroll:0,isScrollTop:!0}),computed:{store(){return this.$store.state.comment},list(){return this.store.list},noMore(){return this.store.noMore},total(){return this.store.total},focusComment(){return this.focusCommentId?this.list.filter(t=>t.id===this.focusCommentId)[0]:null},currentUserId(){return this.$store.state.login?this.$store.state.user.id:0}},mounted(){this.auto?this.$channel.$on(`fire-load-comment-${this.type}-${this.id}`,()=>{this.loadMoreMainComment(!0),this.$channel.$off(`fire-load-comment-${this.type}-${this.id}`)}):this.lazyLoadComment(),this.$channel.$on("load-all-sub-comment",({id:t})=>{this.focusCommentId=t,this.openFocusCommentDrawer=!0}),this.$channel.$on(`open-create-comment-drawer-${this.type}-${this.id}`,()=>{this.currentUserId?this.openCreateCommentDrawer=!0:this.$channel.$emit("sign-in")}),this.$channel.$on("reply-comment",({id:t,targetUserId:e,targetUserName:n})=>{this.handleSubCommentReply({id:t,targetUserId:e,targetUserName:n})}),window.addEventListener("scroll",this.$utils.throttle(()=>{const t=document.documentElement.scrollTop||document.body.scrollTop;this.isScrollTop=this.lastScroll>t,this.lastScroll=t},200))},methods:{async lazyLoadComment(){if(!this.lazy)return void this.$nextTick(()=>{this.scrollToReply()});const{query:t}=this.$route;await this.$store.dispatch("comment/getMainComments",{id:this.id,type:this.type,seeReplyId:t["comment-id"],onlySeeMaster:t.only&&parseInt(t.only,10)?1:0}),this.$nextTick(()=>{this.scrollToReply()})},autoLoadMoreMainComment(){this.loadMoreMainComment(!1)},async loadMoreMainComment(t=!1){if(!this.loadingMainComment){this.loadingMainComment=!0;try{await this.$store.dispatch("comment/getMainComments",{ctx:this,type:this.type,id:this.id,onlySeeMaster:this.onlySeeMaster?1:0,firstRequest:t})}finally{this.loadingMainComment=!1}}},async loadMoreSubComment(){if(!this.loadingSubComment){this.loadingSubComment=!0;try{await this.$store.dispatch("comment/getSubComments",{ctx:this,type:this.type,id:this.focusCommentId})}finally{this.loadingSubComment=!1}}},commentToComment(data){this.handleSubCommentReply({id:data.parent_id,targetUserId:data.from_user_id,targetUserName:data.from_user_name})},handleCommentBtnClick(){this.handleSubCommentReply({id:this.focusComment.id,targetUserId:this.focusComment.from_user_id,targetUserName:this.focusComment.from_user_name})},handleSubCommentReply({id:t,targetUserId:e,targetUserName:n}){this.currentUserId?(this.replyForm.id=t,this.replyForm.targetUserId=e,this.replyForm.targetUserName=n,this.replyForm.open=!0,setTimeout(()=>{document.body.scrollTop=0},200)):this.$channel.$emit("sign-in")},async toggleFocusCommentLike(){if(this.currentUserId){if(!this.replyForm.liking){this.replyForm.liking=!0;try{await this.$store.dispatch("comment/toggleLikeMainComment",{ctx:this,type:this.type,id:this.focusCommentId})}finally{this.replyForm.liking=!1}}}else this.$channel.$emit("sign-in")},async handleReplySubmit(){if(this.currentUserId){if(this.replyForm.content&&!this.replyForm.replying){this.replyForm.replying=!0;try{const t=await this.$store.dispatch("comment/createSubComment",{ctx:this,id:this.replyForm.id,type:this.type,content:this.replyForm.content,targetUserId:this.replyForm.targetUserId});this.replyForm.open=!1,this.replyForm.content="",this.$toast.success(t.message),this.$store.commit("UPDATE_USER_EXP",t.exp)}finally{this.replyForm.replying=!1}}}else this.$channel.$emit("sign-in")},writeComment(){this.$channel.$emit(`open-create-comment-drawer-${this.type}-${this.id}`)},closeCommentDrawer(){this.openCreateCommentDrawer=!1},submitCommentCallback(){this.openCreateCommentDrawer=!1,this.$emit("create-main-comment")},deleteCommentCallback(){this.$emit("delete-main-comment")},scrollToReply(){const t=this.$route.query["comment-id"];if(!t)return;const e=document.getElementById(`comment-${t}`);e&&setTimeout(()=>{Object(o.a)(this.$utils.getOffsetTop(e)-100,600)},400)}}};var C=Object(c.a)(w,function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"comment-wrap"}},[t._ssrNode('<h3 class="title">\n    评论 '+(t.total?"<span>"+t._ssrEscape(t._s(t.total))+"</span>":"\x3c!----\x3e")+"</h3> "),t.list.length?[t._ssrNode('<div id="comment-list-wrap">',"</div>",t._l(t.list,function(e){return t._ssrNode('<div class="comment-item-wrap">',"</div>",[t._t("comment-item",[o("CommentItem",{attrs:{type:t.type,comment:e,"master-id":t.masterId},on:{delete:t.deleteCommentCallback}})],{comment:e,reply:t.handleSubCommentReply})],2)}),0),t._ssrNode(" "),o("FlowState",{attrs:{"no-more":t.noMore,loading:t.loadingMainComment,auto:!0,fetch:t.autoLoadMoreMainComment}}),t._ssrNode(" <button"+t._ssrClass("comment-fixed-btn",{isScrollTop:t.isScrollTop})+'><i class="iconfont icon-talk"></i> <span>回复</span></button>')]:t._ssrNode('<div class="comment-nothing"><img'+t._ssrAttr("src",n(212))+"> <p>还没有人发言呢！</p> <button>\n      抢沙发\n    </button></div>"),t._ssrNode(" "),o("v-drawer",{staticClass:"focus-comment-drawer",attrs:{"header-text":"评论列表"+(t.focusComment&&t.focusComment.floor_count?" - "+t.focusComment.floor_count+" 楼":""),backdrop:!1,from:"bottom",size:"100%"},model:{value:t.openFocusCommentDrawer,callback:function(e){t.openFocusCommentDrawer=e},expression:"openFocusCommentDrawer"}},[t.focusComment?[o("div",{staticClass:"container"},[o("div",{staticClass:"reply"},[o("div",{staticClass:"user clearfix"},[o("nuxt-link",{staticClass:"avatar",attrs:{to:t.$alias.user(t.focusComment.from_user_zone)}},[o("v-img",{attrs:{src:t.focusComment.from_user_avatar,avatar:!0,width:"35"}})],1),t._v(" "),o("div",{staticClass:"summary"},[o("nuxt-link",{staticClass:"nickname",attrs:{to:t.$alias.user(t.focusComment.from_user_zone)},domProps:{textContent:t._s(t.focusComment.from_user_name)}}),t._v(" "),o("div",{staticClass:"info"},[o("v-time",{model:{value:t.focusComment.created_at,callback:function(e){t.$set(t.focusComment,"created_at",e)},expression:"focusComment.created_at"}})],1)],1)],1),t._v(" "),o("div",{staticClass:"content"},[o("div",{staticClass:"text-area",domProps:{innerHTML:t._s(t.focusComment.content)}}),t._v(" "),o("div",{staticClass:"image-area"},t._l(t.focusComment.images,function(img,t){return o("div",{key:t,staticClass:"image-package"},[o("v-img",{attrs:{src:img.url,width:img.width,height:img.height,full:!0}})],1)}),0)]),t._v(" "),o("div",{staticClass:"social"},[o("button",{class:[t.focusComment.liked?"reply-liked-btn":"reply-like-btn"],on:{click:t.toggleFocusCommentLike}},[o("i",{staticClass:"iconfont icon-icon_good"}),t._v(" "),o("span",[t._v(t._s(t.focusComment.liked?"已赞":"赞"))]),t._v(" "),t.focusComment.like_count?o("span",[t._v("("+t._s(t.focusComment.like_count)+")")]):t._e()]),t._v(" "),o("button",{staticClass:"reply-btn fr",on:{click:t.handleCommentBtnClick}},[t._v("\n              回复\n            ")])])]),t._v(" "),o("div",{staticClass:"hr"}),t._v(" "),o("p",{staticClass:"total"},[t._v("\n          "+t._s(t.focusComment.comments.total)+"条回复\n        ")]),t._v(" "),o("ul",{staticClass:"comments"},t._l(t.focusComment.comments.list,function(e){return o("li",{key:e.id},[o("div",{staticClass:"from-user"},[o("nuxt-link",{staticClass:"avatar",attrs:{to:t.$alias.user(e.from_user_zone)}},[o("v-img",{attrs:{src:e.from_user_avatar,avatar:!0,width:"35"}})],1),t._v(" "),o("div",{staticClass:"summary"},[o("div",{staticClass:"users oneline"},[o("nuxt-link",{staticClass:"nickname",attrs:{to:t.$alias.user(e.from_user_zone)},domProps:{textContent:t._s(e.from_user_name)}}),t._v(" "),e.to_user_zone?[t._v("\n                    回复\n                    "),o("nuxt-link",{staticClass:"nickname",attrs:{to:t.$alias.user(e.to_user_zone)},domProps:{textContent:t._s(e.to_user_name)}})]:t._e(),t._v("\n                  :\n                ")],2),t._v(" "),o("div",{staticClass:"info"},[o("v-time",{model:{value:e.created_at,callback:function(n){t.$set(e,"created_at",n)},expression:"item.created_at"}})],1)])],1),t._v(" "),o("div",{staticClass:"main"},[o("div",{staticClass:"content reply-btn",domProps:{textContent:t._s(e.content)},on:{click:function(n){return t.commentToComment(e)}}})])])}),0)]),t._v(" "),o("FlowState",{attrs:{"no-more":t.focusComment.comments.noMore,loading:t.loadingSubComment,fetch:t.loadMoreSubComment}})]:t._e()],2),t._ssrNode(" "),t._ssrNode('<div class="reply-comment-drawer-wrap">',"</div>",[o("v-drawer",{attrs:{"header-text":t.currentUserId===t.replyForm.targetUserId?"回复":"回复："+t.replyForm.targetUserName,backdrop:!1,from:"right",size:"100%","submit-text":"发送"},on:{submit:t.handleReplySubmit},model:{value:t.replyForm.open,callback:function(e){t.$set(t.replyForm,"open",e)},expression:"replyForm.open"}},[o("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.replyForm.content,expression:"replyForm.content",modifiers:{trim:!0}}],attrs:{placeholder:"100字以内任意发挥",maxlength:"100"},domProps:{value:t.replyForm.content},on:{input:function(e){e.target.composing||t.$set(t.replyForm,"content",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])],1),t._ssrNode(" "),o("v-drawer",{attrs:{from:"right",size:"100%","header-text":"发表评论"},model:{value:t.openCreateCommentDrawer,callback:function(e){t.openCreateCommentDrawer=e},expression:"openCreateCommentDrawer"}},[t.openCreateCommentDrawer?o("div",{staticClass:"container"},[t._t("reply-form",[t.openCreateCommentDrawer?o("CommentCreateForm",{attrs:{id:t.id,type:t.type,"master-id":t.masterId},on:{close:t.closeCommentDrawer,submit:t.submitCommentCallback}}):t._e()],{close:t.closeCommentDrawer})],2):t._e()])],2)},[],!1,function(t){var e=n(219);e.__inject__&&e.__inject__(t)},null,"26fa08ed");e.a=C.exports},212:function(t,e,n){t.exports=n.p+"img/e82d3e7.png"},213:function(t,e,n){"use strict";n.r(e);var o=n(185),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},214:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAAxElEQVRYR+2UMQ7CMAxFbYmyw9E6ZGlnrgATAxO9AnO7ZOjRYKdIQdkQ8lL9Wkqkn9k/enr+skrhTwvnEwKiG6JBGkQNoHl2kAZRA2ieHaRB1ACar7ODMcb9suxuKckpG1CVR9N8riGEt2XEc940OE3zPSU5/8KoytB17cUC9Jw3AcdxforI4Q/m1fft0QL0nK8T0HNleQNr/jcNepY+A675v84zgx7XLfM0iNqkQRpEDaB5dpAGUQNonh2kQdQAmi++g1+Jsoopr5i4FgAAAABJRU5ErkJggg=="},215:function(t,e,n){"use strict";n.r(e);var o=n(186),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},216:function(t,e,n){"use strict";n.r(e);var o=n(187),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},217:function(t,e,n){"use strict";n.r(e);var o=n(188),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},218:function(t,e,n){"use strict";n.r(e);var o=n(189),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},219:function(t,e,n){"use strict";n.r(e);var o=n(190),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},221:function(t,e,n){"use strict";n.r(e);var o=n(191),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},224:function(t,e,n){"use strict";var o={props:{type:{required:!0,type:String,validator:t=>~["bangumi","user","question"].indexOf(t)},id:{required:!0,type:Number}},computed:{source(){return this.$store.getters["social/getState"](this.type,this.id)}},methods:{toggleFollow(){this.$store.state.login?this.$store.dispatch("social/toggleAction",{id:this.id,type:this.type,action:"follow"}):this.$channel.$emit("sign-in")}}},r=n(1);var component=Object(r.a)(o,function(){var t=this.$createElement;return(this._self._c||t)("button",{staticClass:"follow-button",on:{click:this.toggleFollow}},[this._ssrNode('<i class="iconfont icon-like"></i> <span>'+this._ssrEscape(this._s(this.source.follow?"已关注":"关注"))+"</span>")])},[],!1,function(t){var e=n(221);e.__inject__&&e.__inject__(t)},null,"bf8ea772");e.a=component.exports},227:function(t,e){},233:function(t,e){},234:function(t,e){},235:function(t,e){},236:function(t,e){},237:function(t,e){},238:function(t,e){},239:function(t,e){},240:function(t,e,n){"use strict";n(89),n(2);var o=n(46),r={name:"VPopover",components:{"el-popover":n.n(o).a},props:{width:{type:Number,default:240},actions:{type:Array,default:()=>[]},reportType:{type:String,default:""},reportId:{type:[Number,String],default:0},reportText:{type:String,default:"举报"},isCreator:{type:Boolean,default:!1},className:{type:String,default:""}},data:()=>({show:!1,backdropId:0}),computed:{actionList(){const t=this.actions;return this.reportId&&t.push({name:this.reportText,method:()=>this.$channel.$emit("open-report-drawer",{id:this.reportId,model:this.reportType,title:this.reportText,isCreator:this.isCreator})}),t}},methods:{handleShow(){this.backdropId=this.$backdrop.show()},handleHide(){this.$backdrop.hide(this.backdropId)},handleClick(){this.show=!1}}},c=n(1);var component=Object(c.a)(r,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{class:t.className},[n("el-popover",{attrs:{width:t.width,trigger:"click","popper-class":"v-popover"},on:{show:t.handleShow,hide:t.handleHide},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("ul",{on:{click:t.handleClick}},t._l(t.actionList,function(e,o){return n("li",{key:o,on:{click:e.method}},[n("i",{staticClass:"el-icon-arrow-right"}),t._v(" "),n("span",{staticClass:"oneline",domProps:{textContent:t._s(e.name)}})])}),0),t._v(" "),t._t("default",null,{slot:"reference"})],2)],1)},[],!1,function(t){var e=n(245);e.__inject__&&e.__inject__(t)},null,"9847f35e");e.a=component.exports},242:function(t,e,n){"use strict";e.a={data:()=>({uploadHeaders:{key:"",token:""},uploadConfig:{max:5},imageUploadAccept:["image/jpeg","image/png","image/jpg","image/gif"].toString(),imageUploadAction:"https://upload.qiniup.com",imagePrefix:"https://image.calibur.tv/",getUpTokenTimer:0,uploadPending:0,uploadImageTotal:0,uploadImageList:[]}),computed:{currentUser(){return this.$store.state.user}},watch:{currentUser:{handler:function(t){t&&t.uptoken&&(this.uploadHeaders.token=t.uptoken.upToken)},deep:!0,immediate:!0}},mounted(){this.getUpTokenTimer=setInterval(()=>{this.getUpToken()},18e5)},beforeDestroy(){this.getUpTokenTimer&&clearInterval(this.getUpTokenTimer)},methods:{async getUpToken(){try{await this.$store.dispatch("getUpToken")}catch(t){}},handleImageUploadError(t,e){console.log(t),this.uploadPending--,this.uploadImageList.forEach((t,n)=>{t.uid===e.uid&&this.uploadImageList.splice(n,1)}),this.$toast.error(`图片：${e.name} 上传失败`)},beforeImageUpload(t){const e=~this.imageUploadAccept.split(",").indexOf(t.type),n=t.size/1024/1024<this.uploadConfig.max;if(!e)return this.$toast.error(`仅支持上传${this.imageUploadAccept.replace(/image\//g,"").replace(/,/g,"、")}格式的图片`),!1;if(!n)return this.$toast.error(`图片大小不能超过 ${this.uploadConfig.max}MB!`),!1;return this.uploadHeaders.key=(({userId:t,page:e,file:n})=>`admin/${t}${e}/${(new Date).getTime()}-${Math.random().toString(36).substring(3,6)}.${n.type.split("/").pop()}`)({userId:this.currentUser.id,page:this.$route.path,file:t}),!0},handleImageUploadRemove(t){this.uploadImageList.forEach((e,n)=>{e.uid===t.uid&&this.uploadImageList.splice(n,1)})},handleImageUploadSuccess(t,e){this.uploadImageList.forEach((n,o)=>{n.uid===e.uid&&(this.uploadImageList[o]=Object.assign(n,{data:t.data,status:"success",url:this.$resize(`${this.imagePrefix}${t.data.url}`,{width:100})}))}),this.uploadImageTotal++,this.uploadPending--},handleImageUploadBefore(t){if(!this.currentUser)return this.$channel.$emit("sign-in"),!1;const e=-1!==this.imageUploadAccept.split(",").indexOf(t.type),n=t.size/1024/1024<this.uploadConfig.max;return e?n?(this.uploadHeaders.key=this.$utils.createFileName({userId:this.$store.state.user.id,type:this.$route.path,file:t}),this.uploadImageList.push({name:t.name,percentage:0,raw:t,size:t.size,status:"uploading",uid:t.uid}),this.uploadPending++,!0):(this.$toast.error(`图片大小不能超过 ${this.uploadConfig.max}MB!`),!1):(this.$toast.error("仅支持jpg, jpeg, png, gif格式的图片"),!1)}}}},243:function(t,e,n){"use strict";n.r(e);var o=n(199),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},245:function(t,e,n){"use strict";n.r(e);var o=n(200),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},248:function(t,e,n){"use strict";var o=n(39),r={name:"VoteButton",props:{type:{required:!0,type:String,validator:t=>~["answer"].indexOf(t)},id:{required:!0,type:Number},score:{required:!0,type:Number},total:{required:!0,type:Number},authorId:{required:!0,type:Number},disabled:{type:Boolean,default:!1}},data(){return{loading:!1,totalVote:this.total,votedScore:this.score}},computed:{currentUserId(){return this.$store.state.login?this.$store.state.user.id:0}},methods:{async voteAction(t){if(!this.disabled)if(this.currentUserId)if(this.currentUserId!==this.authorId){if(!this.loading){this.loading=!0;try{const data=await Object(o.vote)({ctx:this,type:this.type,id:this.id,is_agree:t});this.totalVote=data.total,this.votedScore=data.result}finally{this.loading=!1}}}else this.$toast.error(t?"不能给自己点赞":"不能给自己点反对");else this.$channel.$emit("sign-in")}}},c=n(1);var component=Object(c.a)(r,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"vote-button"},[t._ssrNode("<button"+t._ssrClass("vote-btn vote-up",{active:t.votedScore>0})+'><i class="el-icon-caret-top"></i>'+t._ssrEscape(" 赞同 "+t._s(t.totalVote)+"\n  ")+"</button> <button"+t._ssrClass("vote-btn vote-down",{active:t.votedScore<0})+'><i class="el-icon-caret-bottom"></i></button>')])},[],!1,function(t){var e=n(243);e.__inject__&&e.__inject__(t)},null,"2b97c980");e.a=component.exports},266:function(t,e){},267:function(t,e){},268:function(t,e){},272:function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"c",function(){return r}),n.d(e,"a",function(){return c}),n.d(e,"d",function(){return l});const o=(t,{id:e})=>t.$axios.$get(`question/soga/${e}/show`),r=(t,{id:e})=>t.$axios.$get(`question/soga/${e}/resource`),c=(t,{question_id:e,do_publish:n,geetest:o,source_url:r,content:content,intro:c})=>t.$axios.$post("question/soga/create",{question_id:e,do_publish:n,geetest:o,source_url:r,content:content,intro:c}),l=(t,{question_id:e,do_publish:n,geetest:o,source_url:r,content:content,intro:c,id:l})=>t.$axios.$post(`question/soga/${l}/update`,{question_id:e,do_publish:n,geetest:o,source_url:r,content:content,intro:c})},279:function(t,e,n){"use strict";n.r(e);var o=n(233),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},280:function(t,e,n){"use strict";n.r(e);var o=n(234),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},281:function(t,e,n){"use strict";n.r(e);var o=n(235),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},282:function(t,e,n){"use strict";n.r(e);var o=n(236),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},283:function(t,e,n){"use strict";n.r(e);var o=n(237),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},284:function(t,e,n){"use strict";n.r(e);var o=n(238),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},285:function(t,e,n){"use strict";n.r(e);var o=n(239),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},286:function(t,e,n){"use strict";var o={name:"JsonItem",props:{item:{type:Object,required:!0},selected:{type:Boolean,required:!0,default:!1},index:{type:Number,required:!0}},computed:{sectionCount(){return this.$store.state.editor.sections.length}},methods:{emitPreview(t){this.$emit("preview",{index:this.index,type:t})},emitCreate(t){this.$emit("create",{index:this.index,type:t})},emitDelete(){this.$emit("delete",{index:this.index})},emitSort(){this.$emit("sort",{index:this.index})},computeList(text){let t=text;for(;/\n\n/.test(t);)t=t.replace(/\n\n/g,"\n");return t.split("\n").slice(0,4)}}},r=n(1);var c=Object(r.a)(o,function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{staticClass:"json-item",class:[{selected:t.selected},"json-item-"+t.index]},[t._ssrNode((t.sectionCount>1?'<button class="delete-btn"><span><i class="el-icon-delete"></i></span></button>':"\x3c!----\x3e")+" "+(t.index?'<button class="up-btn"><span><i class="el-icon-arrow-up"></i></span></button>':"\x3c!----\x3e")+' <div class="show-area"><div class="capture">'+("img"===t.item.type?(t.item.url?'<div class="poster"'+t._ssrStyle(null,{backgroundImage:"url("+t.$resize(t.item.url,{width:150})+")"},null)+"></div>":"\x3c!----\x3e")+" "+(t.item.url?"\x3c!----\x3e":'<div class="default green"><i class="iconfont icon-image"></i></div>'):"txt"===t.item.type?'<div class="default yellow"><i class="iconfont icon-text"></i></div>':"list"===t.item.type?'<div class="default blue"><i class="iconfont icon-list"></i></div>':"use"===t.item.type?'<div class="default pink"><i class="iconfont icon-use"></i></div>':"title"===t.item.type?'<div class="default purple"><i class="iconfont icon-title"></i></div>':"\x3c!----\x3e")+'</div> <div class="content">'+("title"===t.item.type?t.item.text?'<div class="text line-4">'+t._s(t.item.text)+"</div>":'<div class="text">\n          点击添加小标题\n        </div>':"txt"===t.item.type?t.item.text?'<div class="text line-4">'+t._s(t.item.text)+"</div>":'<div class="text">\n          点击添加文字\n        </div>':"img"===t.item.type?t.item.text?'<div class="text line-4">'+t._s(t.item.text)+"</div>":t.item.url?'<div class="text">\n          点击编辑图片\n        </div>':'<div class="text">\n          点击上传图片\n        </div>':"list"===t.item.type?t.item.text?'<div class="text line-4">'+("1"===t.item.sort?"<ol>"+t._ssrList(t.computeList(t.item.text),function(li,e){return'<li><span class="oneline">'+t._ssrEscape(t._s(li))+"</span></li>"})+"</ol>":"<ul>"+t._ssrList(t.computeList(t.item.text),function(li,e){return'<li><span class="oneline">'+t._ssrEscape(t._s(li))+"</span></li>"})+"</ul>")+"</div>":'<div class="text">\n          点击添加列表\n        </div>':"use"===t.item.type?t.item.text?'<blockquote class="text line-4">'+t._s(t.item.text)+"</blockquote>":'<div class="text">\n          点击添加引用内容\n        </div>':"\x3c!----\x3e")+'</div></div> <div class="append-area"><button><span><i class="iconfont icon-text"></i></span></button> <button><span><i class="iconfont icon-image"></i></span></button> <button><span><i class="iconfont icon-list"></i></span></button> <button><span><i class="iconfont icon-use"></i></span></button> <button><span><i class="iconfont icon-title"></i></span></button></div>')])},[],!1,function(t){var e=n(279);e.__inject__&&e.__inject__(t)},null,"eb45dc56").exports,l={name:"ImgPreview",mixins:[n(242).a],props:{item:{required:!0,type:Object}},data:()=>({show:!1,saving:!1}),computed:{desc:{get(){return this.item.text},set(t){this.$store.commit("editor/UPDATE_SECTION_TEXT",{value:t})}},imageWrapperHeight(){return{height:`${this.item.height*window.innerWidth/this.item.width+60}px`}}},mounted(){this.$channel.$on("write-save-done",()=>{this.saving=!1}),this.$channel.$on("write-open-drawer",({type:t})=>{"img"===t&&(this.show=!0,this.getUpToken())})},methods:{imageUploadSuccess(t,e){this.handleImageUploadSuccess(t,e),this.$store.commit("editor/UPDATE_SECTION_IMAGE",{url:t.data.url,width:t.data.width,height:t.data.height,size:t.data.size,mime:t.data.type}),this.$toast.success("上传成功")},emitSave(){this.item.url&&(this.$channel.$emit("write-save"),this.saving=!0)}}};var m=Object(r.a)(l,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-drawer",{attrs:{from:"right",size:"100%","header-text":"编辑图片段落","submit-text":"确定"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t.show?n("div",{staticClass:"image-preview container"},[n("div",{staticClass:"body"},[t.item.url?n("div",{staticClass:"wrapper",style:t.imageWrapperHeight},[n("v-img",{attrs:{src:t.$resize(t.item.url),width:t.item.width,height:t.item.height,full:!0}}),t._v(" "),n("el-input",{attrs:{maxlength:"45",placeholder:"添加图片描述"},model:{value:t.desc,callback:function(e){t.desc="string"==typeof e?e.trim():e},expression:"desc"}})],1):n("el-upload",{staticClass:"uploader",attrs:{data:t.uploadHeaders,action:t.imageUploadAction,accept:t.imageUploadAccept,"before-upload":t.handleImageUploadBefore,"on-error":t.handleImageUploadError,"on-success":t.imageUploadSuccess,disabled:!0}},[n("i",{staticClass:"el-icon-plus"}),t._v(" "),n("div",{staticClass:"el-upload__text"},[t._v("\n          点击上传\n        ")])])],1),t._v(" "),n("div",{staticClass:"footer"},[n("el-upload",{attrs:{data:t.uploadHeaders,action:t.imageUploadAction,accept:t.imageUploadAccept,"show-file-list":!1,"before-upload":t.handleImageUploadBefore,"on-error":t.handleImageUploadError,"on-success":t.imageUploadSuccess,disabled:!0}},[t.item.url?n("el-button",{attrs:{size:"small",plain:"",round:""}},[t._v("\n          更换图片\n        ")]):t._e()],1)],1)]):t._e()])},[],!1,function(t){var e=n(280);e.__inject__&&e.__inject__(t)},null,"b3b4ac34").exports,d={name:"TxtPreview",props:{item:{required:!0,type:Object}},data:()=>({show:!1,saving:!1}),computed:{text:{get(){return this.item.text.replace(/<br>/g,"\n")},set(t){this.$store.commit("editor/UPDATE_SECTION_TEXT",{value:t.replace(/\n/g,"<br>")})}}},mounted(){this.$channel.$on("write-save-done",()=>{this.saving=!1}),this.$channel.$on("write-open-drawer",({type:t})=>{"txt"===t&&(this.show=!0)})},methods:{textAreaFocus(){this.text.length<100&&(document.body.scrollTop=0)},emitSave(){this.text.replace(/\n/g,"")&&(this.$channel.$emit("write-save"),this.saving=!0)}}};var h=Object(r.a)(d,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-drawer",{attrs:{from:"right",size:"100%","header-text":"编辑文本段落","submit-text":"确定"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t.show?n("div",{staticClass:"text-preview"},[n("div",{staticClass:"content-wrap"},[n("pre",{staticClass:"shim",domProps:{innerHTML:t._s(t.item.text)}}),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.text,expression:"text",modifiers:{trim:!0}}],attrs:{placeholder:"添加文字内容"},domProps:{value:t.text},on:{focus:t.textAreaFocus,input:function(e){e.target.composing||(t.text=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]):t._e()])},[],!1,function(t){var e=n(281);e.__inject__&&e.__inject__(t)},null,"0357fdce").exports,_=(n(227),n(149)),f={name:"ListPreview",components:{"mt-switch":n.n(_).a},props:{item:{required:!0,type:Object}},data:()=>({show:!1,saving:!1}),computed:{text:{get(){return this.item.text.replace(/<br>/g,"\n")},set(t){this.$store.commit("editor/UPDATE_SECTION_TEXT",{value:t})}},sort:{get(){return"1"===this.item.sort},set(t){this.$store.commit("editor/UPDATE_SECTION_SORT",{value:t?"1":"0"})}}},mounted(){this.$channel.$on("write-save-done",()=>{this.saving=!1}),this.$channel.$on("write-open-drawer",({type:t})=>{"list"===t&&(this.show=!0)})},methods:{textAreaFocus(){this.text.length<100&&(document.body.scrollTop=0)},emitSave(){this.text.replace(/\n/g,"")&&(this.$channel.$emit("write-save"),this.saving=!0)}}};var v=Object(r.a)(f,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-drawer",{attrs:{from:"right",size:"100%","header-text":"编辑列表段落","submit-text":"确定"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t.show?n("div",{staticClass:"list-preview"},[n("div",{staticClass:"sort-wrap"},[n("span",[t._v("顺序："+t._s(t.sort?"有序":"无序"))]),t._v(" "),n("mt-switch",{model:{value:t.sort,callback:function(e){t.sort=e},expression:"sort"}})],1),t._v(" "),n("div",{staticClass:"content-wrap"},[n("pre",{staticClass:"shim",domProps:{innerHTML:t._s(t.item.text)}}),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.text,expression:"text",modifiers:{trim:!0}}],attrs:{placeholder:"添加文字列表，回车分割"},domProps:{value:t.text},on:{focus:t.textAreaFocus,input:function(e){e.target.composing||(t.text=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]):t._e()])},[],!1,function(t){var e=n(282);e.__inject__&&e.__inject__(t)},null,"a062568e").exports,w={name:"UsePreview",props:{item:{required:!0,type:Object}},data:()=>({show:!1,saving:!1}),computed:{text:{get(){return this.item.text.replace(/<br>/g,"\n")},set(t){this.$store.commit("editor/UPDATE_SECTION_TEXT",{value:t.replace(/\n/g,"<br>")})}},title:{get(){return this.item.title},set(t){this.$store.commit("editor/UPDATE_SECTION_TITLE",{value:t})}}},mounted(){this.$channel.$on("write-save-done",()=>{this.saving=!1}),this.$channel.$on("write-open-drawer",({type:t})=>{"use"===t&&(this.show=!0)})},methods:{textAreaFocus(){this.text.length<100&&(document.body.scrollTop=0)},emitSave(){this.text.replace(/\n/g,"")&&(this.$channel.$emit("write-save"),this.saving=!0)}}};var C=Object(r.a)(w,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-drawer",{attrs:{from:"right",size:"100%","header-text":"编辑文本段落","submit-text":"确定"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t.show?n("div",{staticClass:"text-preview"},[n("div",{staticClass:"content-wrap use-wrap"},[n("pre",{staticClass:"shim",domProps:{innerHTML:t._s(t.item.text)}}),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.text,expression:"text",modifiers:{trim:!0}}],attrs:{placeholder:"添加引用的文本"},domProps:{value:t.text},on:{focus:t.textAreaFocus,input:function(e){e.target.composing||(t.text=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})])]):t._e()])},[],!1,function(t){var e=n(283);e.__inject__&&e.__inject__(t)},null,"778c0cbc").exports,y={name:"TxtPreview",props:{item:{required:!0,type:Object}},data:()=>({show:!1,saving:!1}),computed:{text:{get(){return this.item.text},set(t){this.$store.commit("editor/UPDATE_SECTION_TEXT",{value:t})}}},mounted(){this.$channel.$on("write-save-done",()=>{this.saving=!1}),this.$channel.$on("write-open-drawer",({type:t})=>{"title"===t&&(this.show=!0)})},methods:{emitSave(){this.text.replace(/\n/g,"")&&(this.$channel.$emit("write-save"),this.saving=!0)}}};var x=Object(r.a)(y,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-drawer",{attrs:{from:"right",size:"100%","header-text":"编辑文本段落","submit-text":"确定"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[t.show?n("div",{staticClass:"text-preview"},[n("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.text,expression:"text",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:"段落小标题",maxlength:"30"},domProps:{value:t.text},on:{input:function(e){e.target.composing||(t.text=e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}})]):t._e()])},[],!1,function(t){var e=n(284);e.__inject__&&e.__inject__(t)},null,"2df771f1").exports,$=n(194),N={name:"JsonEditorMain",components:{JsonItem:c,ImgPreview:m,TxtPreview:h,ListPreview:v,UsePreview:C,TitlePreview:x},computed:{id(){return+(this.$route.query.id||0)},sections(){return this.$store.state.editor.sections},selectedIndex(){return this.$store.state.editor.selectedIndex},curPreview(){return this.selectedIndex>=0?this.sections[this.selectedIndex]:{}}},mounted(){this.$channel.$on("write-save",()=>{const t=this.getRichContent();t.length?this.$emit("submit",{content:t,desc:this.getPureContent(),publish:!1,id:this.id}):this.$toast.info("内容不能为空！")}),this.$channel.$on("write-publish",()=>{const t=this.getRichContent();t.length?this.$emit("submit",{content:t,desc:this.getPureContent(),publish:!0,id:this.id}):this.$toast.info("内容不能为空！")})},methods:{getRichContent(){const t=[];return this.sections.forEach(e=>{"img"===e.type?e.url&&t.push(e):"txt"===e.type?e.text&&t.push(e):"title"===e.type?e.text&&t.push(e):"use"===e.type?e.text&&t.push(e):"list"===e.type&&e.text&&t.push(e)}),t},getPureContent(){let t="";return this.sections.forEach(e=>{if("txt"===e.type&&e.text&&(t+=`${e.text.replace(/<br>/g,"\n")} `),"title"===e.type&&e.text&&(t+=`${e.text} `),"use"===e.type&&e.text&&(t+=`${e.text.replace(/<br>/g,"\n")} `),"list"===e.type&&e.text){(t=>{if(!t)return[];for(;/\n\n/.test(t);)t=t.replace(/\n\n/g,"\n");return t.split("\n")})(e.text).forEach((p,e)=>{t+=`${e+1}:${p} `})}}),t.slice(0,-1)},handleItemPreview({index:t,type:e}){this.$store.commit("editor/SWITCH_SECTION",{index:t}),this.$channel.$emit("write-open-drawer",{type:e})},handleItemAppend({index:t,type:e}){this.$store.commit("editor/APPEND_SECTION",{index:t,type:e}),this.scrollToBottom(t)},handleItemDelete({index:t}){this.$store.commit("editor/DELETE_SECTION",{index:t})},handleItemSort({index:t}){this.$store.commit("editor/SORT_SECTION",{index:t})},scrollToBottom(t){this.$nextTick(()=>{if(t===this.sections.length-2){const e=document.querySelector(`.json-item-${t}`);Object($.a)(e?this.$utils.getOffsetTop(e)+300:300*t+1e3,1e3,document.getElementById("layout-write"))}})}}};var k=Object(r.a)(N,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"json-editor-main"},[n("transition-group",{staticClass:"editor-tabs",attrs:{name:"list-complete",tag:"div"}},t._l(t.sections,function(e,o){return n("JsonItem",{key:e.id,staticClass:"list-complete-item",attrs:{item:e,index:o,selected:o===t.selectedIndex},on:{preview:t.handleItemPreview,create:t.handleItemAppend,delete:t.handleItemDelete,sort:t.handleItemSort}})}),1),t._ssrNode(" "),n("ImgPreview",{attrs:{item:t.curPreview}}),t._ssrNode(" "),n("TxtPreview",{attrs:{item:t.curPreview}}),t._ssrNode(" "),n("ListPreview",{attrs:{item:t.curPreview}}),t._ssrNode(" "),n("UsePreview",{attrs:{item:t.curPreview}}),t._ssrNode(" "),n("TitlePreview",{attrs:{item:t.curPreview}})],2)},[],!1,function(t){var e=n(285);e.__inject__&&e.__inject__(t)},null,"75215928");e.a=k.exports},306:function(t,e,n){"use strict";n.d(e,"b",function(){return o}),n.d(e,"a",function(){return r});const o=(t,{id:e})=>t.$axios.$get(`question/qaq/${e}/show`),r=(t,{title:title,tags:e,content:content,images:n,intro:o,geetest:r})=>t.$axios.$post("question/qaq/create",{title:title,tags:e,content:content,images:n,intro:o,geetest:r})},356:function(t,e,n){"use strict";n.r(e);var o=n(266),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},357:function(t,e,n){"use strict";n.r(e);var o=n(267),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},358:function(t,e,n){"use strict";n.r(e);var o=n(268),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},359:function(t,e){},378:function(t,e,n){"use strict";var o=n(272),r={name:"CreateAnswerForm",components:{JsonEditor:n(286).a},props:{title:{required:!0,type:String},questionId:{required:!0,type:Number},value:{required:!0,type:Boolean},answerId:{type:Number,default:0},published:{required:!0,type:Boolean}},data(){return{id:this.answerId,show:this.value,source_url:"",saving:!1}},computed:{resource(){return this.$store.state.editor.resource}},mounted(){this.$watch("show",t=>{this.$emit("input",t)}),this.$watch("value",t=>{this.show=t}),this.loadEditContent()},methods:{beforeSubmit(t){!this.source_url||/^https?:\/\/(([a-zA-Z0-9_-])+(\.)?)*(:\d+)?(\/((\.)?(\?)?=?&?[a-zA-Z0-9_-](\?)?)*)*$/i.test(this.source_url)?this.saving||(this.saving=!0,this.id?this.submit(t):this.$captcha({ctx:this,success:({data:data})=>{this.submit(t,data)},close:()=>{this.saving=!1}})):this.$toast.error("请输入合法转载链接")},async submit(t,e={}){this.$toast.loading("保存中"),this.$channel.$emit("write-submit",!0);try{const form={question_id:this.questionId,content:t.content,intro:t.desc.substring(0,120),do_publish:t.publish,source_url:this.source_url.split("?")[0],geetest:e};let n;this.id?(form.id=this.id,await Object(o.d)(this,form)):(n=await Object(o.a)(this,form),this.id=n.data),t.publish?(this.$store.commit("UPDATE_USER_EXP",4),this.$toast.success(void 0!==n?n.message:"发布成功").then(()=>{window.location.href=this.$alias.answer(this.id)})):(this.$toast.success(void 0!==n?n.message:"保存成功"),this.closeEditor())}catch(t){this.$toast.error(t)}finally{this.saving=!1}},loadEditContent(){this.resource&&(this.source_url=this.resource.source_url)},closeEditor(){this.show=!1}}},c=n(1);var l=Object(c.a)(r,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-drawer",{attrs:{"header-text":t.answerId?"编辑回答":"写回答",from:"bottom",size:"100%"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("div",{staticClass:"container",attrs:{id:"create-answer-form"}},[n("h3",{staticClass:"sub-title"},[t._v("\n      转载\n    ")]),t._v(" "),n("el-input",{staticClass:"source-url",attrs:{placeholder:"如果是转载，请复制原文链接至此",size:"medium"},model:{value:t.source_url,callback:function(e){t.source_url=e},expression:"source_url"}}),t._v(" "),n("h3",{staticClass:"sub-title"},[t._v("\n      正文\n    ")]),t._v(" "),n("JsonEditor",{on:{submit:t.beforeSubmit}})],1),t._v(" "),n("div",{staticClass:"qaq-editor-footer"},[n("div",{staticClass:"container"},[t.published?t._e():n("el-button",{attrs:{loading:t.saving,plain:"",size:"medium"},on:{click:function(e){return t.$channel.$emit("write-save")}}},[t._v("\n        "+t._s(t.id?"更新草稿":"存草稿")+"\n      ")]),t._v(" "),n("el-button",{attrs:{loading:t.saving,size:"medium",type:"primary"},on:{click:function(e){return t.$channel.$emit("write-publish")}}},[t._v("\n        "+t._s(t.published?"更新回答":t.id?"发布回答":"提交回答")+"\n      ")])],1)])])},[],!1,function(t){var e=n(357);e.__inject__&&e.__inject__(t)},null,"71c71d27").exports,m=n(224),d=n(206),h={name:"QuestionPanel",components:{CreateAnswerForm:l,VPopover:n(240).a,FollowButton:m.a,CommentMain:d.a},props:{qaq:{required:!0,type:Object},answer:{type:Object,default:null}},data:()=>({collapsed:!0,showCommentModal:!1,showCreateAnswerForm:!1}),computed:{id(){return this.qaq.id},collapsedContent(){let text=this.qaq.intro.substring(0,78);return this.qaq.images.length&&(text+="[图片]"),`${text}...`},isGuest(){return!this.$store.state.login},answerPage(){return"soga-id"===this.$route.name},isMyAnswer(){return!(this.isGuest||!this.answerPage)&&this.answer.user.id===this.$store.state.user.id}},created(){this.collapsed=this.qaq.intro||this.qaq.images.length},methods:{loadQAQComment(){this.showCommentModal=!0,this.$nextTick(()=>{this.$channel.$emit(`fire-load-comment-question-${this.id}`)})},collapsedQAQ(){this.collapsed=!0,window.scrollTo(0,0)},handleCommentChange(t){this.qaq.comment_count+=t},async editMyAnswer(){try{const data=await Object(o.c)(this,{id:this.qaq.my_answer.id});this.$store.commit("editor/INIT_SECTION",data),this.showCreateAnswerForm=!0}catch(t){this.$toast.error(t)}},beginWriteAnswer(){this.$store.state.login?this.showCreateAnswerForm=!0:this.$channel.$emit("sign-in")}}};var _=Object(c.a)(h,function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.qaq?n("div",{attrs:{id:"question-panel"}},[t._ssrNode('<div class="qaq-question">',"</div>",[t._ssrNode('<ul class="qaq-tags">',"</ul>",t._l(t.qaq.tags,function(e){return t._ssrNode("<li>","</li>",[n("nuxt-link",{attrs:{to:t.$alias.bangumi(e.id)},domProps:{textContent:t._s(e.name)}})],1)}),0),t._ssrNode(' <div class="title"><h1>'+t._ssrEscape(t._s(t.qaq.title))+"</h1></div> "),t._ssrNode('<div class="content">',"</div>",[t.collapsed?t._ssrNode('<div class="collapsed-content">',"</div>",[t._ssrNode(t._ssrEscape("\n        "+t._s(t.collapsedContent)+"\n        ")),n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){t.collapsed=!1}}},[t._v("\n          显示全部 "),n("i",{staticClass:"el-icon-arrow-down"})])],2):[t._ssrNode('<div class="text-area">'+t._s(t.qaq.content)+"</div> "),t._l(t.qaq.images,function(img,e){return t._ssrNode('<div class="image-package">',"</div>",[n("v-img",{staticClass:"image",attrs:{src:img.url,width:img.width,height:img.height,full:!0}})],1)})]],2),t._ssrNode(" "),t._ssrNode('<div class="panel">',"</div>",[n("FollowButton",{attrs:{id:t.id,type:"question"}}),t._ssrNode(" "),t.qaq.my_answer?[t.answerPage?[t.isMyAnswer?t._ssrNode('<button class="footer-btn">',"</button>",[t._ssrNode('<i class="el-icon-edit"></i>\n            编辑回答\n          ')],2):t.qaq.my_answer.published_at?n("nuxt-link",{staticClass:"footer-btn",attrs:{to:t.$alias.answer(t.qaq.my_answer.id)}},[n("i",{staticClass:"el-icon-view"}),t._v("\n            查看回答\n          ")]):t._e()]:[t.qaq.my_answer.published_at?n("nuxt-link",{staticClass:"footer-btn",attrs:{to:t.$alias.answer(t.qaq.my_answer.id)}},[n("i",{staticClass:"el-icon-view"}),t._v("\n            查看回答\n          ")]):n("button",{staticClass:"footer-btn",on:{click:t.editMyAnswer}},[n("i",{staticClass:"el-icon-edit"}),t._v("\n            编辑回答\n          ")])]]:t._ssrNode('<button class="footer-btn"><i class="el-icon-edit"></i>\n        写回答\n      </button>'),t._ssrNode(' <button class="footer-btn"><i class="iconfont icon-talk"></i>'+t._ssrEscape("\n        "+t._s(t.qaq.comment_count?t.qaq.comment_count+"条评论":"添加评论")+"\n      ")+"</button> "),t.collapsed?t._e():t._ssrNode('<div class="others">',"</div>",[t._ssrNode('<button class="collapse-btn"><i class="el-icon-arrow-up"></i><span>收起</span></button> '),n("VPopover",{attrs:{"report-id":t.id,"report-type":"question"}},[n("button",{staticClass:"collapse-btn"},[n("i",{staticClass:"el-icon-phone"}),n("span",[t._v("举报")])])])],2)],2)],2),t._ssrNode(" "),n("CreateAnswerForm",{attrs:{title:t.qaq.title,"question-id":t.id,"answer-id":t.qaq.my_answer?t.qaq.my_answer.id:0,published:!!t.qaq.my_answer&&!!t.qaq.published_at},model:{value:t.showCreateAnswerForm,callback:function(e){t.showCreateAnswerForm=e},expression:"showCreateAnswerForm"}}),t._ssrNode(" "),n("v-drawer",{attrs:{from:"bottom",size:"100%"},model:{value:t.showCommentModal,callback:function(e){t.showCommentModal=e},expression:"showCommentModal"}},[n("div",{staticClass:"container"},[n("CommentMain",{attrs:{id:t.id,"master-id":t.qaq.user_id,auto:!0,type:"question"},on:{"delete-main-comment":function(e){return t.handleCommentChange(-1)},"create-main-comment":function(e){return t.handleCommentChange(1)}}},[n("button",{staticClass:"write-btn",staticStyle:{"margin-left":"15px"},attrs:{slot:"header-btn"},on:{click:function(e){t.showCommentModal=!1}},slot:"header-btn"},[t._v("\n          关闭\n        ")])])],1)])],2):t._e()},[],!1,function(t){var e=n(358);e.__inject__&&e.__inject__(t)},null,"55f3e525");e.a=_.exports},382:function(t,e,n){"use strict";var o=n(47),r=n(248),c=n(206),l=n(240),m={name:"AnswerFlowItem",components:{JsonContent:o.a,VoteButton:r.a,CommentMain:c.a,VPopover:l.a},props:{item:{required:!0,type:Object}},data:()=>({showCommentModal:!1}),methods:{loadAnswerComment(){this.showCommentModal=!0,this.$nextTick(()=>{this.$channel.$emit(`fire-load-comment-answer-${this.item.id}`)})},handleCommentChange(t){this.item.comment_count+=t}}},d=n(1);var component=Object(d.a)(m,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"answer-flow-item",attrs:{id:"answer-"+t.item.id}},[t._ssrNode('<header class="answer-header">',"</header>",[n("nuxt-link",{staticClass:"avatar",attrs:{to:t.$alias.user(t.item.user.zone)}},[n("v-img",{attrs:{src:t.item.user.avatar,avatar:!0,width:"38",height:"38"}})],1),t._ssrNode(" "),t._ssrNode('<div class="info">',"</div>",[n("nuxt-link",{staticClass:"nickname",attrs:{to:t.$alias.user(t.item.user.zone)},domProps:{textContent:t._s(t.item.user.nickname)}}),t._ssrNode(' <p class="oneline signature">'+t._ssrEscape(t._s(t.item.user.signature))+"</p>")],2)],2),t._ssrNode(" "),t.item.vote_count?t._ssrNode('<div class="answer-meta">',"</div>",[t.item.source_url?t._ssrNode("<span>","</span>",[n("nuxt-link",{attrs:{href:t.item.source_url,target:"_blank"}},[t._v("\n        原文链接\n      ")]),t._ssrNode("\n      ·\n    ")],2):t._e(),t._ssrNode(" "),t.item.created_at===t.item.published_at?t._ssrNode("<span>","</span>",[t._ssrNode("\n      发布于\n      "),n("v-time",{model:{value:t.item.created_at,callback:function(e){t.$set(t.item,"created_at",e)},expression:"item.created_at"}})],2):t._ssrNode("<span>","</span>",[t._ssrNode("\n      编辑于\n      "),n("v-time",{model:{value:t.item.published_at,callback:function(e){t.$set(t.item,"published_at",e)},expression:"item.published_at"}})],2),t._ssrNode("\n    ·\n    <span>"+t._ssrEscape(" "+t._s(t.item.vote_count)+" 赞同了该回答 ")+"</span>")],2):t._e(),t._ssrNode(" "),t._ssrNode('<main class="answer-content">',"</main>",[n("JsonContent",{attrs:{content:t.item.content}})],1),t._ssrNode(" "),t._ssrNode('<footer class="answer-footer">',"</footer>",[n("VoteButton",{attrs:{id:t.item.id,total:t.item.vote_count,score:t.item.voted,"author-id":t.item.user.id,type:"answer"}}),t._ssrNode(" "),n("el-button",{attrs:{type:"text",size:"medium"},on:{click:t.loadAnswerComment}},[n("i",{staticClass:"iconfont icon-talk"}),t._v("\n      "+t._s(t.item.comment_count?t.item.comment_count+" 条评论":"添加评论")+"\n    ")]),t._ssrNode(" "),n("VPopover",{attrs:{"report-id":t.item.id,"is-creator":!t.item.source_url,"report-type":"answer"}},[n("el-button",{attrs:{type:"text",size:"medium"}},[n("i",{staticClass:"el-icon-phone"}),t._v("\n        举报\n      ")])],1)],2),t._ssrNode(" "),n("v-drawer",{attrs:{from:"bottom",size:"80%"},model:{value:t.showCommentModal,callback:function(e){t.showCommentModal=e},expression:"showCommentModal"}},[n("div",{staticClass:"container"},[n("CommentMain",{attrs:{id:t.item.id,"master-id":t.item.user.id,auto:!0,type:"answer"},on:{"delete-main-comment":function(e){return t.handleCommentChange(-1)},"create-main-comment":function(e){return t.handleCommentChange(1)}}},[n("button",{staticClass:"write-btn",staticStyle:{"margin-left":"15px"},attrs:{slot:"header-btn"},on:{click:function(e){t.showCommentModal=!1}},slot:"header-btn"},[t._v("\n          关闭\n        ")])])],1)])],2)},[],!1,function(t){var e=n(356);e.__inject__&&e.__inject__(t)},null,"03cfb4ea");e.a=component.exports},442:function(t,e,n){"use strict";n.r(e);var o=n(359),r=n.n(o);for(var c in o)"default"!==c&&function(t){n.d(e,t,function(){return o[t]})}(c);e.default=r.a},484:function(t,e,n){"use strict";n.r(e);var o=n(177),r=n(382),c=n(378),l=n(306),m={name:"QuestionShow",components:{FlowList:o.a,AnswerFlowItem:r.a,QuestionPanel:c.a},props:{id:{type:String,required:!0}},data:()=>({qaq:null}),asyncData({app:t,store:e,params:n,error:o}){const{id:r}=n;return Object(l.b)(t,{id:r}).then(t=>(e.commit("social/SET_STATE",{type:"question",id:t.id,data:{follow:t.followed,follow_users:t.follow_users}}),{qaq:t})).catch(t=>{o({statusCode:t.statusCode,message:t.message})})},async fetch({store:t,params:e}){await t.dispatch("flow/initData",{id:e.id,func:"getQuestionAnswers",type:"seenIds",sort:"active"})},head(){return{title:this.qaq.title}}},d=n(1);var component=Object(d.a)(m,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"question-show"}},[n("QuestionPanel",{attrs:{qaq:t.qaq}}),t._ssrNode(" "),t.qaq.answer_count?t._ssrNode('<div class="answers">',"</div>",[t._ssrNode('<div class="answers-title"><h2>'+t._ssrEscape(t._s(t.qaq.answer_count)+" 个回答")+"</h2></div> "),n("FlowList",{attrs:{id:t.id,func:"getQuestionAnswers",sort:"active",type:"seenIds"},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.flow;return n("ul",{staticClass:"answer-flow-list"},t._l(o,function(e){return n("AnswerFlowItem",{key:e.id,attrs:{item:e,qaq:t.qaq}})}),1)}}],null,!1,1737031715)})],2):n("more-btn",{attrs:{"no-more":!0,loading:!1,length:0}})],2)},[],!1,function(t){var e=n(442);e.__inject__&&e.__inject__(t)},null,"5a3c5ad0");e.default=component.exports}};
//# sourceMappingURL=_id.chunk.c9c6ee3d.js.map