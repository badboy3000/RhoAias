(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{500:function(t,a,e){t.exports={"bangumi-panel":"bangumi-panel-b5",bangumiPanel:"bangumi-panel-b5",avatar:"avatar-2K",content:"content-2m",name:"name-5O",controls:"controls-1p",rolling:"rolling-nc"}},525:function(t,a,e){"use strict";var n=e(500),s=e.n(n);a.default=s.a},526:function(t,a,e){"use strict";e(45);var n={name:"BangumiPanel",components:{FollowButton:e(531).a},props:{id:{required:!0,type:Number},avatar:{required:!0,type:String},name:{required:!0,type:String}}},s=e(525),r=e(1);var i=Object(r.a)(n,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{class:t.$style.bangumiPanel},[e("nuxt-link",{class:t.$style.avatar,attrs:{to:t.$alias.bangumi(t.id)}},[e("v-img",{attrs:{src:t.avatar,width:"80",height:"92"}})],1),t._v(" "),e("div",{class:t.$style.content},[e("nuxt-link",{attrs:{to:t.$alias.bangumi(t.id)}},[e("h5",{staticClass:"oneline",class:t.$style.name,domProps:{textContent:t._s(t.name)}})]),t._v(" "),e("div",{class:t.$style.summary},[t._t("default")],2),t._v(" "),e("div",{class:t.$style.controls},[e("follow-button",{attrs:{id:t.id,type:"bangumi"}})],1)],1)],1)},[],!1,function(t){this.$style=s.default.locals||s.default},null,null);i.options.__file="BangumiPanel.vue";a.a=i.exports},642:function(t,a,e){},810:function(t,a,e){"use strict";var n=e(642);e.n(n).a},939:function(t,a,e){"use strict";e.r(a);e(24),e(13),e(12);var n=e(2),s=e.n(n),r=e(543),i=e(526),o=e(523),c=(e(39),e(40),function(t,a){var e=a.id;return t.$axios.$get("cartoon_role/".concat(e,"/show"))}),l={name:"RoleShow",validate:function(t){var a=t.params;return/^\d+$/.test(a.id)},asyncData:function(){var t=s()(regeneratorRuntime.mark(function t(a){var e,n,s,r,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=a.app,n=a.store,s=a.params,r=a.error,i=s.id,t.abrupt("return",c(e,{id:i}).then(function(t){var a=t.bangumi;return n.commit("social/SET_STATE",{type:"bangumi",id:a.id,data:{follow:a.followed}}),{info:t,role:t.data,bangumi:a}}).catch(r));case 3:case"end":return t.stop()}},t,this)}));return function(a){return t.apply(this,arguments)}}(),head:function(){return{title:"《".concat(this.bangumi.name,"》—— ").concat(this.role.name),meta:[{hid:"description",name:"description",content:"calibur.tv，一个兴趣使然的二次元综合网站"}]}},components:{CommentMain:r.a,BangumiPanel:i.a,VPopover:o.a},data:function(){var t=this;return{sort:"comment",loadingRoleFans:!1,loadingRoleImage:!1,roleImageLoaded:!1,fetchFansSort:"new",fansSortActions:[{name:"最多应援",method:function(){t.fetchFansSort="hot",t.fetchRoleFans(!0)}},{name:"最新应援",method:function(){t.fetchFansSort="new",t.fetchRoleFans(!0)}}]}},computed:{id:function(){return+this.$route.params.id},images:function(){return this.info.images},fans:function(){return"new"===this.fetchFansSort?this.latestFans:this.biggestFans},latestFans:function(){return this.$store.getters["flow/getFlow"]("cartoonRoleFans","new",this.id)},biggestFans:function(){return this.$store.getters["flow/getFlow"]("cartoonRoleFans","hot",this.id)},computeRoleAlias:function(){return this.role.alias.split(",")}},methods:{switchTab:function(t){this.sort=t,"image"===t?this.getRoleImages(!0):"fans"===t&&this.fetchRoleFans(!0)},handleStarRole:function(){var t=s()(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.$store.state.login){t.next=3;break}return this.$channel.$emit("sign-in"),t.abrupt("return");case 3:if(this.$store.state.user.coin){t.next=6;break}return this.$toast.error("团子不足"),t.abrupt("return");case 6:return t.prev=6,t.next=9,this.$store.dispatch("cartoonRole/star",{bangumiId:this.bangumi.id,roleId:this.id,ctx:this,hasStar:this.role.hasStar});case 9:this.$store.commit("USE_COIN"),this.$toast.info("+".concat(this.role.hasStar,"s")),t.next=15;break;case 13:t.prev=13,t.t0=t.catch(6);case 15:case"end":return t.stop()}},t,this,[[6,13]])}));return function(){return t.apply(this,arguments)}}(),fetchRoleFans:function(){var t=s()(regeneratorRuntime.mark(function t(){var a,e=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.length>0&&void 0!==e[0]&&e[0],!this.loadingRoleFans){t.next=3;break}return t.abrupt("return");case 3:if(!a){t.next=9;break}return this.loadingRoleFans=!0,t.next=7,this.$store.dispatch("flow/initData",{func:"cartoonRoleFans",type:"new"===this.fetchFansSort?"lastId":"seenIds",sort:this.fetchFansSort,id:this.id});case 7:return this.loadingRoleFans=!1,t.abrupt("return");case 9:this.loadingRoleFans=!0;try{this.$store.dispatch("flow/loadMore",{func:"cartoonRoleFans",type:"new"===this.fetchFansSort?"lastId":"seenIds",sort:this.fetchFansSort,id:this.id})}finally{this.loadingRoleFans=!1}case 11:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getRoleImages:function(){var t=s()(regeneratorRuntime.mark(function t(){var a,e=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!(a=e.length>0&&void 0!==e[0]&&e[0])||!this.roleImageLoaded){t.next=3;break}return t.abrupt("return");case 3:if(!this.loadingRoleImage){t.next=5;break}return t.abrupt("return");case 5:return this.loadingRoleImage=!0,t.prev=6,t.next=9,this.$store.dispatch("image/getRoleImages",{ctx:this,id:this.id,force:a});case 9:this.roleImageLoaded=!0;case 10:return t.prev=10,this.loadingRoleImage=!1,t.finish(10);case 13:case"end":return t.stop()}},t,this,[[6,,10,13]])}));return function(){return t.apply(this,arguments)}}(),loadMoreFans:function(){this.$store.dispatch("flow/loadMore",{func:"cartoonRoleFans",type:"new"===this.fetchFansSort?"lastId":"seenIds",sort:this.fetchFansSort,id:this.id})}}},u=(e(810),e(1)),h=Object(u.a)(l,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"role-show",attrs:{id:"role-show"}},[e("div",{staticClass:"container"},[e("div",{staticClass:"profile clearfix"},[e("h3",{staticClass:"sub-title"},[t._v("角色信息")]),t._v(" "),e("div",[e("div",{staticClass:"clearfix"},[e("v-img",{staticClass:"avatar",attrs:{src:t.role.avatar,share:!0,width:80}}),t._v(" "),e("div",{staticClass:"info"},[e("h1",{staticClass:"name",domProps:{textContent:t._s(t.role.name)}}),t._v(" "),e("div",{staticClass:"lover"},[t.role.lover?[e("a",{attrs:{href:t.$alias.user(t.role.lover.zone)}},[t._v("\n                  守护者：\n                  "),e("v-img",{staticClass:"image",attrs:{src:t.role.lover.avatar,avatar:!0,width:26}}),t._v("\n                  "+t._s(t.role.lover.nickname)+"\n                ")],1)]:t._e()],2),t._v(" "),e("button",{staticClass:"star",on:{click:t.handleStarRole}},[t._v("为TA应援")])])],1),t._v(" "),e("div",[e("h3",{staticClass:"sub-title"},[t._v("角色简介")]),t._v(" "),e("p",{staticClass:"summary"},[e("strong",[t._v("介绍：")]),t._v(t._s(t.role.intro)+"\n          ")]),t._v(" "),e("ul",{staticClass:"alias clearfix"},[e("strong",[t._v("别名：")]),t._v(" "),t._l(t.computeRoleAlias,function(a,n){return e("li",{key:n,domProps:{textContent:t._s(a)}})})],2),t._v(" "),t.role.star_count?e("p",{staticClass:"coin"},[e("strong",[t._v("粉丝：")]),t._v("共有 "+t._s(t.role.fans_count)+" 个粉丝，收获了 "+t._s(t.role.star_count)+" 个团子\n          ")]):t._e()])])]),t._v(" "),e("div",{staticClass:"bangumi"},[e("h3",{staticClass:"sub-title"},[t._v("所属番剧")]),t._v(" "),e("bangumi-panel",{attrs:{id:t.bangumi.id,avatar:t.bangumi.avatar,name:t.bangumi.name}},[e("p",{staticClass:"summary",domProps:{textContent:t._s(t.bangumi.summary)}})])],1)]),t._v(" "),e("div",{staticClass:"tabs"},[e("button",{class:{active:"comment"===t.sort},on:{click:function(a){t.switchTab("comment")}}},[t._v("留言板")]),t._v(" "),e("button",{class:{active:"fans"===t.sort},on:{click:function(a){t.switchTab("fans")}}},[t._v("应援团")]),t._v(" "),"fans"===t.sort?e("v-popover",{attrs:{actions:t.fansSortActions,"class-name":"fans-sort-btn"}},[e("span",[e("i",{staticClass:"el-icon-d-caret"}),t._v("\n        排序\n      ")])]):t._e()],1),t._v(" "),e("div",{staticClass:"tab-card"},["fans"===t.sort?[e("ul",{staticClass:"role-fans container"},t._l(t.fans.list,function(a,n){return e("li",{key:n},[e("a",{attrs:{href:t.$alias.user(a.zone)}},[e("v-img",{staticClass:"avatar",attrs:{src:a.avatar,avatar:!0,width:30}}),t._v("\n            "+t._s(a.nickname)+"\n            "),"new"===t.fetchFansSort?e("v-time",{staticClass:"score",model:{value:a.score,callback:function(e){t.$set(a,"score",e)},expression:"item.score"}}):e("span",{staticClass:"score"},[t._v(t._s(a.score)+"个团子")])],1)])}),0),t._v(" "),e("more-btn",{attrs:{"no-more":t.fans.noMore,length:t.fans.list.length,loading:t.loadingRoleFans},on:{fetch:function(a){t.fetchRoleFans(!1)}}})]:"comment"===t.sort?e("div",{staticClass:"role-comment-wrap"},[e("v-lazy",[e("comment-main",{attrs:{id:t.id,"master-id":1,type:"role"}})],1)],1):t._e()],2)])},[],!1,null,null,null);h.options.__file="_id.vue";a.default=h.exports}}]);
//# sourceMappingURL=_id.chunk.b4d66cc7.js.map