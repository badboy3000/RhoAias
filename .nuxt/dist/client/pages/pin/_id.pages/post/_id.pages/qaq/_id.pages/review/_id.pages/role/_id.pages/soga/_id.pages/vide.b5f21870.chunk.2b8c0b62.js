(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{523:function(t,e,n){"use strict";n(45),n(262),n(3);var r=n(168),o={name:"VPopover",components:{"el-popover":n.n(r).a},props:{width:{type:Number,default:240},actions:{type:Array,default:function(){return[]}},reportType:{type:String,default:""},reportId:{type:Number,default:0},reportText:{type:String,default:"举报"},isCreator:{type:Boolean,default:!1},className:{type:String,default:""}},data:function(){return{show:!1,backdropId:0}},computed:{actionList:function(){var t=this,e=this.actions;return this.reportId&&e.push({name:this.reportText,method:function(){return t.$channel.$emit("open-report-drawer",{id:t.reportId,model:t.reportType,title:t.reportText,isCreator:t.isCreator})}}),e}},methods:{handleShow:function(){this.backdropId=this.$backdrop.show()},handleHide:function(){this.$backdrop.hide(this.backdropId)},handleClick:function(){this.show=!1}}},i=(n(618),n(1)),s=Object(i.a)(o,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{class:t.className},[n("el-popover",{attrs:{width:t.width,trigger:"click","popper-class":"v-popover"},on:{show:t.handleShow,hide:t.handleHide},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("ul",{on:{click:t.handleClick}},t._l(t.actionList,function(e,r){return n("li",{key:r,on:{click:e.method}},[n("i",{staticClass:"el-icon-arrow-right"}),t._v(" "),n("span",{staticClass:"oneline",domProps:{textContent:t._s(e.name)}})])}),0),t._v(" "),t._t("default",null,{slot:"reference"})],2)],1)},[],!1,null,null,null);s.options.__file="Popover.vue";e.a=s.exports},531:function(t,e,n){"use strict";n(45);var r={props:{type:{required:!0,type:String,validator:function(t){return~["bangumi","user","question"].indexOf(t)}},id:{required:!0,type:Number}},computed:{source:function(){return this.$store.getters["social/getState"](this.type,this.id)}},methods:{toggleFollow:function(){this.$store.state.login?this.$store.dispatch("social/toggleAction",{id:this.id,type:this.type,action:"follow"}):this.$channel.$emit("sign-in")}}},o=(n(623),n(1)),i=Object(o.a)(r,function(){var t=this.$createElement,e=this._self._c||t;return e("button",{staticClass:"follow-button",on:{click:this.toggleFollow}},[e("i",{staticClass:"iconfont icon-like"}),this._v(" "+this._s(this.source.follow?"已关注":"关注")+"\n")])},[],!1,null,null,null);i.options.__file="FollowButton.vue";e.a=i.exports},538:function(t,e,n){},539:function(t,e,n){},543:function(t,e,n){"use strict";n(12);var r=n(2),o=n.n(r),i=(n(45),n(10),function(t,e,n,r){var o=0,i=n?[n]:[document.getElementsByTagName("html")[0],document.body],s=n?n.scrollTop:window.scrollY,a=t||0,m=e||2e3,c=r||"easeOutSine",u=Math.max(.1,Math.min(Math.abs(s-a)/m,.8)),l={easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)}};i.forEach(function(t){t.requestAnimFrame||(t.requestAnimFrame=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}).bind(window))}),function t(){var e=(o+=1/60)/u,n=l[c](e);i.forEach(function(r){e<1?(r.requestAnimFrame(t),r.scrollTop=s+(a-s)*n):r.scrollTop=a})}()}),s={name:"CommentCreateForm",props:{type:{required:!0,type:String},id:{required:!0,type:[Number,String]},masterId:{required:!0,type:Number}},data:function(){return{content:""}},computed:{isGuest:function(){return!this.$store.state.login},submitting:function(){return this.$store.state.comment.submitting}},methods:{submit:function(){var t=o()(regeneratorRuntime.mark(function t(){var e,n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isGuest){t.next=3;break}return this.$channel.$emit("sign-in"),t.abrupt("return");case 3:if(this.content){t.next=6;break}return this.$emit("close"),t.abrupt("return");case 6:if(!this.submitting){t.next=8;break}return t.abrupt("return");case 8:return this.$store.commit("comment/SET_SUBMITTING",{result:!0}),t.prev=9,t.next=12,this.$store.dispatch("comment/createMainComment",{content:this.content,images:[],type:this.type,id:this.id,ctx:this});case 12:e=t.sent,this.$toast.success(e.message),this.$store.commit("UPDATE_USER_EXP",e.exp),this.$emit("submit"),this.content="",setTimeout(function(){var t=document.getElementById("comment-".concat(e.data.id));t&&i(n.$utils.getOffsetTop(t)-100,600)},400);case 18:return t.prev=18,this.$store.commit("comment/SET_SUBMITTING",{result:!1}),t.finish(18);case 21:case"end":return t.stop()}},t,this,[[9,,18,21]])}));return function(){return t.apply(this,arguments)}}(),handleAreaFocus:function(){document.body.scrollTop=0}}},a=(n(798),n(1)),m=Object(a.a)(s,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-create-form"},[n("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.content,expression:"content",modifiers:{trim:!0}}],staticClass:"content",attrs:{placeholder:"来吧，尽情的（在1000字以内）发挥吧",maxlength:"1000"},domProps:{value:t.content},on:{focus:t.handleAreaFocus,input:function(e){e.target.composing||(t.content=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}}),t._v(" "),n("el-button",{staticClass:"submit-btn",attrs:{loading:t.submitting,type:"primary"},on:{click:t.submit}},[t._v("发布")])],1)},[],!1,null,null,null);m.options.__file="CommentCreateForm.vue";var c=m.exports,u=n(721),l={name:"CommentCommentItem",components:{VPopover:n(523).a,SubCommentList:u.a},props:{comment:{required:!0,type:Object},masterId:{required:!0,type:Number},type:{required:!0,type:String}},data:function(){return{deleting:!1,liking:!1}},computed:{currentUserId:function(){return this.$store.state.login?this.$store.state.user.id:0},isMine:function(){return this.currentUserId===this.comment.from_user_id},canDelete:function(){return this.isMine||this.currentUserId===this.masterId},actions:function(){var t=[];return this.canDelete&&t.push({name:"删除",method:this.deleteComment}),t.push({name:this.comment.liked?"取消赞":"点赞",method:this.toggleLike}),t}},methods:{toggleLike:function(){var t=o()(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.currentUserId){t.next=3;break}return this.$channel.$emit("sign-in"),t.abrupt("return");case 3:if(!this.liking){t.next=5;break}return t.abrupt("return");case 5:return this.liking=!0,t.prev=6,t.next=9,this.$store.dispatch("comment/toggleLikeMainComment",{ctx:this,type:this.type,id:this.comment.id});case 9:return t.prev=9,this.liking=!1,t.finish(9);case 12:case"end":return t.stop()}},t,this,[[6,,9,12]])}));return function(){return t.apply(this,arguments)}}(),deleteComment:function(){var t=this;this.deleting||(this.deleting=!0,this.$confirm("删除后无法找回, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$store.dispatch("comment/deleteMainComment",{ctx:t,type:t.type,id:t.comment.id}),t.$emit("delete")}).catch(function(){t.deleting=!1}))},handleCommentBtnClick:function(){this.$channel.$emit("reply-comment",{id:this.comment.id,targetUserId:this.comment.from_user_id,targetUserName:this.comment.from_user_name})}}},d=(n(801),Object(a.a)(l,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-item",attrs:{id:"comment-"+t.comment.id}},[n("a",{staticClass:"avatar",attrs:{href:t.$alias.user(t.comment.from_user_zone)}},[n("v-img",{attrs:{src:t.comment.from_user_avatar,avatar:!0,width:"35"}})],1),t._v(" "),n("div",{staticClass:"content"},[n("div",{staticClass:"header"},[n("v-popover",{attrs:{actions:t.actions,"report-id":t.comment.id,"report-type":t.type+"_comment"}},[n("button",{staticClass:"tools-btn"},[t._v("···")])]),t._v(" "),n("div",{staticClass:"user"},[n("a",{staticClass:"nickname oneline",attrs:{href:t.$alias.user(t.comment.from_user_zone)}},[n("span",{domProps:{textContent:t._s(t.comment.from_user_name)}}),t._v(" "),t.comment.is_owner?n("span",[t._v("(楼主)")]):t._e(),t._v(" "),t.comment.is_leader?n("i",{staticClass:"iconfont icon-leader"}):t.comment.is_master?n("i",{staticClass:"iconfont icon-master"}):t._e()]),t._v(" "),n("div",{staticClass:"info"},[n("span",[t._v("第"+t._s(t.comment.floor_count-1)+"楼")]),t._v(" "),n("span",[t._v("·")]),t._v(" "),n("v-time",{model:{value:t.comment.created_at,callback:function(e){t.$set(t.comment,"created_at",e)},expression:"comment.created_at"}})],1)])],1),t._v(" "),n("div",{staticClass:"main",domProps:{innerHTML:t._s(t.comment.content)}}),t._v(" "),n("div",{staticClass:"footer"},[n("sub-comment-list",{attrs:{"parent-comment":t.comment,type:t.type}}),t._v(" "),n("div",{staticClass:"social"},[n("button",{class:[t.comment.liked?"reply-liked-btn":"reply-like-btn"],on:{click:t.toggleLike}},[n("i",{staticClass:"iconfont icon-icon_good"}),t._v("\n          "+t._s(t.comment.liked?"已赞":"赞")+"\n          "),t.comment.like_count?n("span",[t._v("("+t._s(t.comment.like_count)+")")]):t._e()]),t._v(" "),n("button",{staticClass:"reply-btn fr",on:{click:t.handleCommentBtnClick}},[t._v("\n          回复\n        ")])])],1)])])},[],!1,null,null,null));d.options.__file="CommentItem.vue";var p={name:"VCommentMain",components:{CommentCreateForm:c,CommentItem:d.exports},props:{id:{required:!0,type:[Number,String]},type:{required:!0,type:String,validator:function(t){return~["post","video","image","score","question","answer","role"].indexOf(t)}},onlySeeMaster:{type:Boolean,default:!1},emptyText:{type:String,default:"暂无评论，快来抢沙发吧╮(￣▽￣)╭！"},masterId:{required:!0,type:Number},bottomAppendComment:{type:Boolean,default:!0},auto:{type:Boolean,default:!1},lazy:{type:Boolean,default:!0}},data:function(){return{loadingMainComment:!1,focusCommentId:0,openFocusCommentDrawer:!1,loadingSubComment:!1,replyForm:{id:"",content:"",targetUserId:0,targetUserName:"",open:!1,replying:!1,liking:!1},openCreateCommentDrawer:!1}},computed:{store:function(){return this.$store.state.comment},list:function(){return this.store.list},noMore:function(){return this.store.noMore},total:function(){return this.store.total},focusComment:function(){var t=this;return this.focusCommentId?this.list.filter(function(e){return e.id===t.focusCommentId})[0]:null},currentUserId:function(){return this.$store.state.login?this.$store.state.user.id:0}},mounted:function(){var t=this;this.auto?this.$channel.$on("fire-load-comment-".concat(this.type,"-").concat(this.id),function(){t.loadMoreMainComment(!0),t.$channel.$off("fire-load-comment-".concat(t.type,"-").concat(t.id))}):this.lazyLoadComment(),this.$channel.$on("load-all-sub-comment",function(e){var n=e.id;t.focusCommentId=n,t.openFocusCommentDrawer=!0}),this.$channel.$on("open-create-comment-drawer-".concat(this.type,"-").concat(this.id),function(){t.currentUserId?t.openCreateCommentDrawer=!0:t.$channel.$emit("sign-in")}),this.$channel.$on("reply-comment",function(e){var n=e.id,r=e.targetUserId,o=e.targetUserName;t.handleSubCommentReply({id:n,targetUserId:r,targetUserName:o})}),document.getElementById("comment-wrap").addEventListener("click",function(e){if(/reply-btn/.test(e.target.className)&&t.$el.contains(e.target)){var n=document.getElementById("reply-comment-textarea");n.style.display="block",n.focus()}})},methods:{lazyLoadComment:function(){var t=o()(regeneratorRuntime.mark(function t(){var e,n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.lazy){t.next=3;break}return this.$nextTick(function(){n.scrollToReply()}),t.abrupt("return");case 3:return e=this.$route.query,t.next=6,this.$store.dispatch("comment/getMainComments",{id:this.id,type:this.type,seeReplyId:e["comment-id"],onlySeeMaster:e.only&&parseInt(e.only,10)?1:0});case 6:this.$nextTick(function(){n.scrollToReply()});case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),loadMoreMainComment:function(){var t=o()(regeneratorRuntime.mark(function t(){var e,n=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=n.length>0&&void 0!==n[0]&&n[0],!this.loadingMainComment){t.next=3;break}return t.abrupt("return");case 3:return this.loadingMainComment=!0,t.prev=4,t.next=7,this.$store.dispatch("comment/getMainComments",{ctx:this,type:this.type,id:this.id,onlySeeMaster:this.onlySeeMaster?1:0,firstRequest:e});case 7:return t.prev=7,this.loadingMainComment=!1,t.finish(7);case 10:case"end":return t.stop()}},t,this,[[4,,7,10]])}));return function(){return t.apply(this,arguments)}}(),loadMoreSubComment:function(){var t=o()(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.loadingSubComment){t.next=2;break}return t.abrupt("return");case 2:return this.loadingSubComment=!0,t.prev=3,t.next=6,this.$store.dispatch("comment/getSubComments",{ctx:this,type:this.type,id:this.focusCommentId});case 6:return t.prev=6,this.loadingSubComment=!1,t.finish(6);case 9:case"end":return t.stop()}},t,this,[[3,,6,9]])}));return function(){return t.apply(this,arguments)}}(),commentToComment:function(t){this.handleSubCommentReply({id:t.parent_id,targetUserId:t.from_user_id,targetUserName:t.from_user_name})},handleCommentBtnClick:function(){this.handleSubCommentReply({id:this.focusComment.id,targetUserId:this.focusComment.from_user_id,targetUserName:this.focusComment.from_user_name})},handleSubCommentReply:function(t){var e=t.id,n=t.targetUserId,r=t.targetUserName;this.currentUserId?(this.replyForm.id=e,this.replyForm.targetUserId=n,this.replyForm.targetUserName=r,this.replyForm.open=!0,setTimeout(function(){document.body.scrollTop=0},200)):this.$channel.$emit("sign-in")},toggleFocusCommentLike:function(){var t=o()(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.currentUserId){t.next=3;break}return this.$channel.$emit("sign-in"),t.abrupt("return");case 3:if(!this.replyForm.liking){t.next=5;break}return t.abrupt("return");case 5:return this.replyForm.liking=!0,t.prev=6,t.next=9,this.$store.dispatch("comment/toggleLikeMainComment",{ctx:this,type:this.type,id:this.focusCommentId});case 9:return t.prev=9,this.replyForm.liking=!1,t.finish(9);case 12:case"end":return t.stop()}},t,this,[[6,,9,12]])}));return function(){return t.apply(this,arguments)}}(),handleReplyDrawerClose:function(){document.getElementById("reply-comment-textarea").style.display="none"},handleReplySubmit:function(){var t=o()(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.currentUserId){t.next=3;break}return this.$channel.$emit("sign-in"),t.abrupt("return");case 3:if(this.replyForm.content){t.next=5;break}return t.abrupt("return");case 5:if(!this.replyForm.replying){t.next=7;break}return t.abrupt("return");case 7:return this.replyForm.replying=!0,t.prev=8,t.next=11,this.$store.dispatch("comment/createSubComment",{ctx:this,id:this.replyForm.id,type:this.type,content:this.replyForm.content,targetUserId:this.replyForm.targetUserId});case 11:e=t.sent,this.replyForm.open=!1,this.replyForm.content="",this.$toast.success(e.message),this.$store.commit("UPDATE_USER_EXP",e.exp);case 16:return t.prev=16,this.replyForm.replying=!1,this.handleReplyDrawerClose(),t.finish(16);case 20:case"end":return t.stop()}},t,this,[[8,,16,20]])}));return function(){return t.apply(this,arguments)}}(),writeComment:function(){this.$channel.$emit("open-create-comment-drawer-".concat(this.type,"-").concat(this.id))},closeCommentDrawer:function(){this.openCreateCommentDrawer=!1},submitCommentCallback:function(){this.openCreateCommentDrawer=!1,this.$emit("create-main-comment")},deleteCommentCallback:function(){this.$emit("delete-main-comment")},scrollToReply:function(){var t=this,e=this.$route.query["comment-id"];if(e){var n=document.getElementById("comment-".concat(e));n&&setTimeout(function(){i(t.$utils.getOffsetTop(n)-100,600)},400)}}}},h=(n(802),Object(a.a)(p,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"comment-wrap"}},[t._t("header",[t.auto?t._e():n("div",{staticClass:"hr"}),t._v(" "),n("h3",{staticClass:"sub-title"},[t._v("\n      评论"+t._s(t.total?"("+t.total+")":"")+" "),t._t("header-btn"),t._v(" "),n("button",{staticClass:"write-btn",on:{click:t.writeComment}},[t._v("写评论")])],2)]),t._v(" "),t.list.length?[n("div",{attrs:{id:"comment-list-wrap"}},t._l(t.list,function(e){return n("div",{key:e.id,staticClass:"comment-item-wrap"},[t._t("comment-item",[n("comment-item",{attrs:{type:t.type,comment:e,"master-id":t.masterId},on:{delete:t.deleteCommentCallback}})],{comment:e,reply:t.handleSubCommentReply})],2)}),0),t._v(" "),n("div",{attrs:{id:"comment-list-footer"}},[t.bottomAppendComment?n("button",{staticClass:"append-comment-btn",on:{click:t.writeComment}},[t._v("\n        写评论\n      ")]):t._e(),t._v(" "),n("more-btn",{attrs:{"no-more":t.noMore,loading:t.loadingMainComment,auto:!0},on:{fetch:function(e){t.loadMoreMainComment(!1)}}})],1)]:t.emptyText?n("p",{staticClass:"no-content",domProps:{textContent:t._s(t.emptyText)}}):t._e(),t._v(" "),n("v-drawer",{staticClass:"focus-comment-drawer",attrs:{"header-text":"评论列表"+(t.focusComment&&t.focusComment.floor_count?" - "+t.focusComment.floor_count+" 楼":""),backdrop:!1,from:"bottom",size:"100%"},model:{value:t.openFocusCommentDrawer,callback:function(e){t.openFocusCommentDrawer=e},expression:"openFocusCommentDrawer"}},[t.focusComment?[n("div",{staticClass:"container"},[n("div",{staticClass:"reply"},[n("div",{staticClass:"user clearfix"},[n("a",{staticClass:"avatar",attrs:{href:t.$alias.user(t.focusComment.from_user_zone)}},[n("v-img",{attrs:{src:t.focusComment.from_user_avatar,avatar:!0,width:"35"}})],1),t._v(" "),n("div",{staticClass:"summary"},[n("a",{staticClass:"nickname",attrs:{href:t.$alias.user(t.focusComment.from_user_zone)},domProps:{textContent:t._s(t.focusComment.from_user_name)}}),t._v(" "),n("div",{staticClass:"info"},[n("v-time",{model:{value:t.focusComment.created_at,callback:function(e){t.$set(t.focusComment,"created_at",e)},expression:"focusComment.created_at"}})],1)])]),t._v(" "),n("div",{staticClass:"content"},[n("div",{staticClass:"text-area",domProps:{innerHTML:t._s(t.focusComment.content)}}),t._v(" "),n("div",{staticClass:"image-area"},t._l(t.focusComment.images,function(t,e){return n("div",{key:e,staticClass:"image-package"},[n("v-img",{attrs:{src:t.url,width:t.width,height:t.height,full:!0}})],1)}),0)]),t._v(" "),n("div",{staticClass:"social"},[n("button",{class:[t.focusComment.liked?"reply-liked-btn":"reply-like-btn"],on:{click:t.toggleFocusCommentLike}},[n("i",{staticClass:"iconfont icon-icon_good"}),t._v("\n              "+t._s(t.focusComment.liked?"已赞":"赞")+"\n              "),t.focusComment.like_count?n("span",[t._v("("+t._s(t.focusComment.like_count)+")")]):t._e()]),t._v(" "),n("button",{staticClass:"reply-btn fr",on:{click:t.handleCommentBtnClick}},[t._v("\n              回复\n            ")])])]),t._v(" "),n("div",{staticClass:"hr"}),t._v(" "),n("p",{staticClass:"total"},[t._v(t._s(t.focusComment.comments.total)+"条回复")]),t._v(" "),n("ul",{staticClass:"comments"},t._l(t.focusComment.comments.list,function(e){return n("li",{key:e.id},[n("div",{staticClass:"from-user"},[n("a",{staticClass:"avatar",attrs:{href:t.$alias.user(e.from_user_zone)}},[n("v-img",{attrs:{src:e.from_user_avatar,avatar:!0,width:"35"}})],1),t._v(" "),n("div",{staticClass:"summary"},[n("div",{staticClass:"users oneline"},[n("a",{staticClass:"nickname",attrs:{href:t.$alias.user(e.from_user_zone)},domProps:{textContent:t._s(e.from_user_name)}}),t._v(" "),e.to_user_zone?[t._v("\n                    回复\n                    "),n("a",{staticClass:"nickname",attrs:{href:t.$alias.user(e.to_user_zone)},domProps:{textContent:t._s(e.to_user_name)}})]:t._e(),t._v("\n                  :\n                ")],2),t._v(" "),n("div",{staticClass:"info"},[n("v-time",{model:{value:e.created_at,callback:function(n){t.$set(e,"created_at",n)},expression:"item.created_at"}})],1)])]),t._v(" "),n("div",{staticClass:"main"},[n("div",{staticClass:"content reply-btn",domProps:{textContent:t._s(e.content)},on:{click:function(n){t.commentToComment(e)}}})])])}),0)]),t._v(" "),n("more-btn",{attrs:{"no-more":t.focusComment.comments.noMore,loading:t.loadingSubComment},on:{fetch:t.loadMoreSubComment}})]:t._e()],2),t._v(" "),n("div",{staticClass:"reply-comment-drawer-wrap"},[n("v-drawer",{staticClass:"reply-comment-drawer",attrs:{"header-text":t.currentUserId===t.replyForm.targetUserId?"回复":"回复："+t.replyForm.targetUserName,backdrop:!1,from:"right",size:"100%","submit-text":"发布"},on:{cancel:t.handleReplyDrawerClose,submit:t.handleReplySubmit},model:{value:t.replyForm.open,callback:function(e){t.$set(t.replyForm,"open",e)},expression:"replyForm.open"}}),t._v(" "),n("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.replyForm.content,expression:"replyForm.content",modifiers:{trim:!0}}],class:{"fade-in":t.replyForm.open},attrs:{id:"reply-comment-textarea",placeholder:"100字以内任意发挥",maxlength:"100"},domProps:{value:t.replyForm.content},on:{input:function(e){e.target.composing||t.$set(t.replyForm,"content",e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})],1),t._v(" "),n("v-drawer",{attrs:{from:"right",size:"100%","header-text":"发表评论"},model:{value:t.openCreateCommentDrawer,callback:function(e){t.openCreateCommentDrawer=e},expression:"openCreateCommentDrawer"}},[t.openCreateCommentDrawer?n("div",{staticClass:"container"},[t._t("reply-form",[t.openCreateCommentDrawer?n("comment-create-form",{attrs:{id:t.id,type:t.type,"master-id":t.masterId},on:{close:t.closeCommentDrawer,submit:t.submitCommentCallback}}):t._e()],{close:t.closeCommentDrawer})],2):t._e()])],2)},[],!1,null,null,null));h.options.__file="CommentMain.vue";e.a=h.exports},618:function(t,e,n){"use strict";var r=n(538);n.n(r).a},623:function(t,e,n){"use strict";var r=n(539);n.n(r).a},629:function(t,e,n){},630:function(t,e,n){},631:function(t,e,n){},632:function(t,e,n){},633:function(t,e,n){},721:function(t,e,n){"use strict";n(45);var r={name:"SubCommentItem",props:{comment:{required:!0,type:Object},parentUserId:{required:!0,type:Number},parentCommentId:{required:!0,type:Number},type:{required:!0,type:String}},data:function(){return{deleting:!1}},computed:{currentUserId:function(){return this.$store.state.login?this.$store.state.user.id:0},isMine:function(){return this.currentUserId===this.comment.from_user_id},canDelete:function(){return this.isMine||this.currentUserId===this.parentUserId}},methods:{handleSubCommentClick:function(){if(this.isMine)return this.deleteComment(),void this.$nextTick(function(){document.getElementById("reply-comment-textarea").style.display="none"});this.currentUserId&&this.$channel.$emit("reply-comment",{id:this.parentCommentId,targetUserId:this.comment.from_user_id,targetUserName:this.comment.from_user_name})},deleteComment:function(){var t=this;this.canDelete&&(this.deleting||(this.deleting=!0,this.$confirm("删除后无法找回, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$store.dispatch("comment/deleteSubComment",{ctx:t,type:t.type,id:t.comment.id,parentId:t.comment.parent_id})}).catch(function(){t.deleting=!1})))}}},o=(n(799),n(1)),i=Object(o.a)(r,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"sub-comment-item"},[n("a",{staticClass:"nickname",attrs:{href:t.$alias.user(t.comment.from_user_zone)},domProps:{textContent:t._s(t.comment.from_user_name)}}),t._v(" "),t.comment.to_user_zone?[t._v("\n    回复\n    "),n("a",{staticClass:"nickname",attrs:{href:t.$alias.user(t.comment.to_user_zone)},domProps:{textContent:t._s(t.comment.to_user_name)}})]:t._e(),t._v("\n  :\n  "),n("span",{staticClass:"reply-btn comment-content",on:{click:t.handleSubCommentClick}},[t._v(t._s(t.comment.content))])],2)},[],!1,null,null,null);i.options.__file="SubCommentItem.vue";var s={name:"PostSubCommentList",components:{SubCommentItem:i.exports},props:{parentComment:{required:!0,type:Object},type:{required:!0,type:String}},computed:{comments:function(){return this.parentComment.comments},authorId:function(){return this.parentComment.from_user_id},hasComment:function(){return!!this.comments.list.length},filterComments:function(){var t=this.comments,e=t.list,n=e.slice(0,5);if(e.every(function(e){return e.id<=t.maxId}))return n;var r=n.map(function(t){return t.id});return n.concat(e.filter(function(e){return e.id>t.maxId&&-1===r.indexOf(e.id)}))}},methods:{loadAllComment:function(){this.$channel.$emit("load-all-sub-comment",{id:this.parentComment.id})}}},a=(n(800),Object(o.a)(s,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"sub-comment-list-wrap"},[t.hasComment?n("div",{staticClass:"sub-comment-list"},[t._l(t.filterComments,function(e){return n("sub-comment-item",{key:e.id,attrs:{comment:e,"parent-user-id":t.authorId,"parent-comment-id":t.parentComment.id,type:t.type}})}),t._v(" "),!t.comments.noMore||t.comments.list.length>5?n("button",{staticClass:"load-all-comment",on:{click:t.loadAllComment}},[t._v("\n      查看全部"+t._s(t.comments.total)+"条评论\n    ")]):t._e()],2):t._e()])},[],!1,null,null,null));a.options.__file="SubCommentList.vue";e.a=a.exports},798:function(t,e,n){"use strict";var r=n(629);n.n(r).a},799:function(t,e,n){"use strict";var r=n(630);n.n(r).a},800:function(t,e,n){"use strict";var r=n(631);n.n(r).a},801:function(t,e,n){"use strict";var r=n(632);n.n(r).a},802:function(t,e,n){"use strict";var r=n(633);n.n(r).a}}]);
//# sourceMappingURL=vide.b5f21870.chunk.2b8c0b62.js.map