(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{500:function(t,e,i){t.exports={"bangumi-panel":"bangumi-panel-b5",bangumiPanel:"bangumi-panel-b5",avatar:"avatar-2K",content:"content-2m",name:"name-5O",controls:"controls-1p",rolling:"rolling-nc"}},506:function(t,e,i){},525:function(t,e,i){"use strict";var n=i(500),s=i.n(n);e.default=s.a},526:function(t,e,i){"use strict";i(45);var n={name:"BangumiPanel",components:{FollowButton:i(531).a},props:{id:{required:!0,type:Number},avatar:{required:!0,type:String},name:{required:!0,type:String}}},s=i(525),a=i(1);var r=Object(a.a)(n,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{class:t.$style.bangumiPanel},[i("nuxt-link",{class:t.$style.avatar,attrs:{to:t.$alias.bangumi(t.id)}},[i("v-img",{attrs:{src:t.avatar,width:"80",height:"92"}})],1),t._v(" "),i("div",{class:t.$style.content},[i("nuxt-link",{attrs:{to:t.$alias.bangumi(t.id)}},[i("h5",{staticClass:"oneline",class:t.$style.name,domProps:{textContent:t._s(t.name)}})]),t._v(" "),i("div",{class:t.$style.summary},[t._t("default")],2),t._v(" "),i("div",{class:t.$style.controls},[i("follow-button",{attrs:{id:t.id,type:"bangumi"}})],1)],1)],1)},[],!1,function(t){this.$style=s.default.locals||s.default},null,null);r.options.__file="BangumiPanel.vue";e.a=r.exports},536:function(t,e,i){"use strict";i(12);var n=i(2),s=i.n(n);e.a={fetch:function(){var t=s()(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.store,t.next=3,i.dispatch("initAuth");case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}},540:function(t,e,i){"use strict";var n=i(506);i.n(n).a},547:function(t,e,i){"use strict";i(12);var n=i(2),s=i.n(n),a=(i(45),{name:"SocialPanel",props:{isCreator:{required:!0,type:Boolean},isMine:{required:!0,type:Boolean},id:{required:!0,type:Number},type:{required:!0,type:String,validator:function(t){return~["post","video","image","score","answer","video"].indexOf(t)}}},computed:{isGuest:function(){return!this.$store.state.login},source:function(){return this.$store.getters["social/getState"](this.type,this.id)},displayUsers:function(){return(this.isCreator?this.source.reward_users.list:this.source.like_users.list).slice(0,this.displayCount)}},methods:{computeTextByAction:function(t){return"reward"===t?"投食":"like"===t?"喜欢":"mark"===t?"收藏":"操作"},toggleAction:function(t){var e=this;if(this.isGuest)this.$channel.$emit("sign-in");else if(this.isMine)this.$toast.info("不能".concat(this.computeTextByAction(t),"自己的内容"));else if("reward"===t){if(this.source.reward)return void this.$toast.info("已投食过");this.$confirm("向TA投食需要消耗你一个团子，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.submitAction("reward")}).catch(function(){})}else this.submitAction(t)},submitAction:function(){var t=s()(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("social/toggleAction",{type:this.type,id:this.id,action:e});case 2:(i=t.sent).success&&this.$emit("".concat(e,"-callback"),{result:i.result});case 4:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}}),r=(i(540),i(1)),o=Object(r.a)(a,function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.source?i("div",{staticClass:"social-panel"},[i("div",{staticClass:"buttons"},[t.isCreator?i("el-button",{class:{"is-plain":t.source.reward},attrs:{loading:t.source.reward_loading,type:"warning",icon:"iconfont icon-fantuan",round:"",size:"mini"},on:{click:function(e){t.toggleAction("reward")}}},[t._v("\n      "+t._s(t.source.reward?"已投食":"投食")+t._s(t.source.reward_users.total?"  |  "+t.source.reward_users.total:"")+"\n    ")]):t._e(),t._v(" "),i("el-button",{class:{"is-plain":t.source.like},attrs:{loading:t.source.like_loading,type:"danger",icon:"iconfont icon-like",round:"",size:"mini"},on:{click:function(e){t.toggleAction("like")}}},[t._v("\n      "+t._s(t.source.like?"已喜欢":"喜欢")+t._s(t.source.like_users.total?"  |  "+t.source.like_users.total:"")+"\n    ")]),t._v(" "),i("el-button",{class:{"is-plain":t.source.mark},attrs:{loading:t.source.mark_loading,type:"success",icon:"iconfont icon--mark",round:"",size:"mini"},on:{click:function(e){t.toggleAction("mark")}}},[t._v("\n      "+t._s(t.source.mark?"已收藏":"收藏")+t._s(t.source.mark_users.total?"  |  "+t.source.mark_users.total:"")+"\n    ")])],1),t._v(" "),i("div",{staticClass:"users"},[i("ul",t._l(t.displayUsers,function(e){return i("li",{key:e.id,staticClass:"user-face"},[i("img",{attrs:{src:t.$resize(e.avatar,{width:60})}})])}),0)])]):t._e()},[],!1,null,null,null);o.options.__file="SocialPanel.vue";e.a=o.exports},649:function(t,e,i){},818:function(t,e,i){"use strict";var n=i(649);i.n(n).a},940:function(t,e,i){"use strict";i.r(e);i(24),i(10),i(13),i(12);var n=i(2),s=i.n(n),a=function(t,e){var i=e.id;return t.$axios.$get("video/".concat(i,"/show?refer=web"))},r=i(543),o=i(547),c=i(526),l=i(536),u={name:"VideoShow",validate:function(t){var e=t.params;return/^\d+$/.test(e.id)},asyncData:function(){var t=s()(regeneratorRuntime.mark(function t(e){var i,n,s,r,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=e.app,n=e.store,s=e.params,r=e.error,o=s.id,t.abrupt("return",a(i,{id:o}).then(function(t){var e=t.bangumi,i=t.info;return n.commit("social/SET_STATE",{type:"video",id:o,data:{like:i.liked,reward:i.rewarded,mark:i.marked,like_users:i.like_users,mark_users:i.mark_users,reward_users:i.reward_users}}),n.commit("social/SET_STATE",{type:"bangumi",id:e.id,data:{follow:e.followed}}),t}).catch(r));case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),components:{CommentMain:r.a,SocialPanel:o.a,BangumiPanel:c.a},mixins:[l.a],props:{id:{type:String,required:!0}},head:function(){var t=this.bangumi,e=this.info,i=this.list,n=i.has_season,s=t.name,a=e.name,r=e.part,o="";return n&&i.videos.forEach(function(t){t.data.forEach(function(n){n.id===e.id&&(r=n.part-t.base,o=i.name)})}),{title:o?o===a?"".concat(s," : ").concat(o," - 视频"):"".concat(s," : ").concat(o," : 第").concat(r,"话 ").concat(a," - 视频"):"".concat(s," : 第").concat(r,"话 ").concat(a," - 视频"),meta:[{hid:"description",name:"description",content:t.summary},{hid:"keywords",name:"keywords",content:"".concat(s,"，第").concat(r,"话，").concat(a,"，在线观看 动画片大全 动漫在线播放 日本动漫 好看的动漫 二次元网站")}]}},data:function(){return{maxWidth:0,take:4,part:0,page:0,showAll:!1,firstPlay:!0,player:null,playing:!1,notSupport:!1,loading:!1,info:null,bangumi:null,list:[],ip_blocked:!1,must_reward:!1,need_min_level:0}},computed:{isGuest:function(){return!this.$store.state.login},isMine:function(){return!!this.$store.state.login&&this.info.user_id===this.$store.state.user.id},videos:function(){var t=[];return this.list.videos.forEach(function(e){t=t.concat(e.data)}),t},sortVideos:function(){var t=(this.page-1)*this.take;return this.showAll?this.videos:this.videos.slice(t,t+this.take)},useOtherSiteSource:function(){return this.info.other_site},videoSrc:function(){return this.info.src},isFlv:function(){return!this.useOtherSiteSource&&(!!this.videoSrc&&"flv"===this.videoSrc.split("?")[0].split(".").pop().toLowerCase())},nextPartVideo:function(){var t=this,e=0,i=+this.id;return this.videos.forEach(function(n,s){n.id===i&&s!==t.videos.length-1&&(e=t.videos[s+1].id)}),e?this.$alias.video(e):""},showMoreBtn:function(){return this.take<this.videos.length},showLevelThrottle:function(){return!this.$store.state.login||this.$store.state.user.exp.level<this.need_min_level},needCoin:function(){return this.must_reward&&!this.info.rewarded}},mounted:function(){var t=this;if(this.computePage(),this.isFlv)this.notSupport=!0;else if(!(!this.videoSrc||this.useOtherSiteSource||this.showLevelThrottle||this.needCoin||this.isGuest||this.ip_blocked)){this.player=this.$refs.video;try{this.player.load()}catch(t){return void this.$alert(this.errorTips)}this.player.addEventListener("pause",function(){t.playing=!1}),this.player.addEventListener("waiting",function(){t.loading=!0}),this.player.addEventListener("playing",function(){t.playing=!0,t.handlePlaying()}),this.player.addEventListener("timeupdate",function(){t.loading=!1}),this.player.addEventListener("abort",function(){t.$alert(t.errorTips)}),this.player.addEventListener("error",function(){t.$alert(t.errorTips)})}},methods:{computePage:function(){var t=this;this.videos.forEach(function(e){e.id===+t.id&&(t.part=e.part)}),this.page=Math.ceil(this.part/this.take)},handlePlaying:function(){var t,e,i;this.firstPlay&&(this.loading=!0,this.firstPlay=!1,t=this,e={id:this.id},i=e.id,t.$axios.$post("video/playing",{id:i}))},handleVideoReportClick:function(){this.$channel.$emit("open-feedback",{type:4,desc:"【H5】-《".concat(this.bangumi.name,"》第").concat(this.part,"话 视频有错误，错误详情为：{?}"),placeholder:"请填写错误详情"})},handleRewardAction:function(){this.must_reward&&window.location.reload()}}},d=(i(818),i(1)),h=Object(d.a)(u,function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"video-show",attrs:{id:"video-show"}},[i("div",{staticClass:"video"},[t.videoSrc?t.useOtherSiteSource?[i("p",[t._v("应版权方要求 (⇀‸↼‶)，该视频暂不提供站内播放")]),t._v(" "),i("a",{attrs:{href:t.videoSrc,target:"_blank"}},[t._v("播放链接")])]:t.notSupport?[i("p",[t._v("该视频格式仅支持在电脑上播放 (눈_눈)")])]:t.isGuest?[i("p",[t._v("流量压力太大了 (ಥ_ಥ)，需要登录才能看番")]),t._v(" "),i("a",{on:{click:function(e){t.$channel.$emit("sign-in",!1)}}},[t._v("立即登录")])]:t.ip_blocked?[i("p",[t._v("\n        你已被禁止看视频功能，请加QQ群解禁\n      ")])]:t.needCoin?[t._m(0),t._v(" "),i("a",{attrs:{href:"https://www.calibur.tv/post/2282"}},[t._v("  为什么要限流？")])]:t.showLevelThrottle?[i("p",[t._v("\n        该视频需要你的等级至少 "+t._s(t.need_min_level)+" 才能播放\n      ")]),t._v(" "),i("a",{attrs:{href:"https://www.calibur.tv/post/2282"}},[t._v("  为什么要限流？")]),t._v(" "),i("a",{attrs:{href:"https://www.calibur.tv/post/2279"}},[t._v("  如何升级？")])]:t.info?i("video",{ref:"video",attrs:{src:t.videoSrc,poster:t.info.poster,preload:"none",controls:"controls",controlsList:"nodownload"}}):t._e():[i("p",[t._v("这个资源消失了_〆(´Д｀ )")])],t._v(" "),i("img",{staticClass:"share-poster",attrs:{src:t.$resize(t.info.poster,{width:200})}})],2),t._v(" "),i("div",{staticClass:"container"},[i("div",{attrs:{id:"metas"}},[i("h3",{staticClass:"sub-title"},[t._v("\n        选集（"+t._s(t.videos.length)+"）\n        "),t.nextPartVideo?i("a",{staticClass:"next",attrs:{href:t.nextPartVideo}},[t._v("下一话")]):t._e(),t._v(" "),t.showMoreBtn?i("div",{staticClass:"more",on:{click:function(e){t.showAll=!t.showAll}}},[t._v(t._s(t.showAll?"收起":"展开"))]):t._e()]),t._v(" "),t.list.has_season&&t.showAll?t._l(t.list.videos,function(e,n){return i("div",{key:n},[i("h6",{staticClass:"season-title",domProps:{textContent:t._s(e.name)}}),t._v(" "),i("ul",t._l(e.data,function(n){return i("li",{key:n.id},[i("a",{staticClass:"meta oneline",class:{"a-active":t.$route.params.id==n.id},attrs:{href:t.$alias.video(n.id)}},[t._v("\n                第"+t._s(n.part-e.base)+"话\n              ")])])}),0)])}):i("ul",t._l(t.sortVideos,function(e){return i("li",{key:e.id},[i("a",{staticClass:"meta oneline",class:{"a-active":t.$route.params.id==e.id},attrs:{href:t.$alias.video(e.id)}},[t._v("\n            第"+t._s(e.part)+"话\n          ")])])}),0)],2),t._v(" "),i("social-panel",{attrs:{id:t.info.id,"is-creator":t.info.is_creator,"is-mine":t.isMine,type:"video"},on:{"reward-callback":t.handleRewardAction}}),t._v(" "),i("h3",{staticClass:"sub-title"},[t._v("番剧简介")]),t._v(" "),t.bangumi?i("bangumi-panel",{staticClass:"bangumi-panel",attrs:{id:t.bangumi.id,avatar:t.bangumi.avatar,name:t.bangumi.name}},[i("p",{staticClass:"part"},[t._v("第"+t._s(t.info.part)+"话 "+t._s(t.info.name))])]):t._e(),t._v(" "),i("h3",{staticClass:"sub-title"},[t._v("视频反馈")]),t._v(" "),t._m(1),t._v(" "),i("p",{staticClass:"tip"},[t._v("2：安卓用户建议大家使用最新版 QQ 浏览器在线播放，不要使用系统自带的浏览器")]),t._v(" "),i("p",{staticClass:"tip"},[t._v("3：iOS用户建议使用自带的 Safari 播放")]),t._v(" "),i("div",[i("button",{staticClass:"video-report-btn",on:{click:t.handleVideoReportClick}},[t._v("视频报错")])]),t._v(" "),i("v-lazy",[i("comment-main",{attrs:{id:t.id,"master-id":t.info.user_id,type:"video"}})],1)],1)])},[function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("\n        该视频需要投食之后才能播放\n        "),e("br"),this._v("\n        团子可通过签到等方式获得\n      ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"tip"},[this._v("1：大家可以加入QQ群 "),e("strong",[this._v("106402736")]),this._v("、"),e("strong",[this._v("806818950")]),this._v(" 获得最新的资源更新提醒")])}],!1,null,null,null);h.options.__file="_id.vue";e.default=h.exports}}]);
//# sourceMappingURL=_id.chunk.decdd2ab.js.map